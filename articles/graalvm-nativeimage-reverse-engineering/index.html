<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>GraalVM NativeImage 逆向还原 - Protector4J</title><meta name="description"/><meta name="next-head-count" content="4"/><script>
  let darkModeMediaQuery = window.matchMedia('(prefers-color-scheme: dark)')

  updateMode()
  darkModeMediaQuery.addEventListener('change', updateModeWithoutTransitions)
  window.addEventListener('storage', updateModeWithoutTransitions)

  function updateMode() {
    let isSystemDarkMode = darkModeMediaQuery.matches
    let isDarkMode = window.localStorage.isDarkMode === 'true' || (!('isDarkMode' in window.localStorage) && isSystemDarkMode)

    if (isDarkMode) {
      document.documentElement.classList.add('dark')
    } else {
      document.documentElement.classList.remove('dark')
    }

    if (isDarkMode === isSystemDarkMode) {
      delete window.localStorage.isDarkMode
    }
  }

  function disableTransitionsTemporarily() {
    document.documentElement.classList.add('[&_*]:!transition-none')
    window.setTimeout(() => {
      document.documentElement.classList.remove('[&_*]:!transition-none')
    }, 0)
  }

  function updateModeWithoutTransitions() {
    disableTransitionsTemporarily()
    updateMode()
  }
</script><meta name="keywords" content="java,class,protect,encrypt,decompile,anti-decompile"/><link rel="preload" href="/_next/static/css/d9374e5bb63561d3.css" as="style"/><link rel="stylesheet" href="/_next/static/css/d9374e5bb63561d3.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-c02d60f7f9250038.js" defer=""></script><script src="/_next/static/chunks/framework-2c79e2a64abdb08b.js" defer=""></script><script src="/_next/static/chunks/main-5959997af754dca6.js" defer=""></script><script src="/_next/static/chunks/pages/_app-be59c33f36ab07b6.js" defer=""></script><script src="/_next/static/chunks/pages/articles/graalvm-nativeimage-reverse-engineering-408c8a745cfcd2b5.js" defer=""></script><script src="/_next/static/Fa23PQWnAWdb7ainqjCCc/_buildManifest.js" defer=""></script><script src="/_next/static/Fa23PQWnAWdb7ainqjCCc/_ssgManifest.js" defer=""></script></head><body class="bg-white antialiased dark:bg-zinc-900"><div id="__next"><header><div class="fixed top-0 left-0 inset-x-0 z-30"><nav class="bg-white dark:bg-gray-900 border-gray-200 dark:border-gray-600 border-b"><div class="w-full"><div class="flex flex-wrap items-center justify-between p-4 max-w-screen-xl mx-auto"><a class="flex items-center" href="/"><img alt="Protector4J Logo" loading="lazy" width="192" height="192" decoding="async" data-nimg="1" class="h-8 w-8 mr-3" style="color:transparent" src="/_next/static/media/p4j.0b69c567.png"/><span class="self-center text-xl font-semibold whitespace-nowrap dark:text-white">Protector4J</span></a><div class="items-center justify-between hidden w-full md:flex md:w-auto" id="navbar-sticky"><ul class="flex flex-col p-4 md:p-0 mt-4 font-medium border border-gray-100 rounded-lg bg-gray-50 md:flex-row md:space-x-8 md:mt-0 md:border-0 md:bg-white dark:bg-gray-800 md:dark:bg-gray-900 dark:border-gray-700"><li><a class="block py-2 pl-3 pr-4 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:hover:text-blue-700 md:p-0 md:dark:hover:text-blue-500 dark:text-white dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent dark:border-gray-700" href="/">Home</a></li><li><a class="block py-2 pl-3 pr-4 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:hover:text-blue-700 md:p-0 md:dark:hover:text-blue-500 dark:text-white dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent dark:border-gray-700" href="/download/">Download</a></li><li><a class="block py-2 pl-3 pr-4 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:hover:text-blue-700 md:p-0 md:dark:hover:text-blue-500 dark:text-white dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent dark:border-gray-700" href="/purchase/">Purchase</a></li><li><a class="block py-2 pl-3 pr-4 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:hover:text-blue-700 md:p-0 md:dark:hover:text-blue-500 dark:text-white dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent dark:border-gray-700" href="/addons/">Addons</a></li><li><a class="block py-2 pl-3 pr-4 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:hover:text-blue-700 md:p-0 md:dark:hover:text-blue-500 dark:text-white dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent dark:border-gray-700" href="/#contact">Contact</a></li><li><a class="block py-2 pl-3 pr-4 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:hover:text-blue-700 md:p-0 md:dark:hover:text-blue-500 dark:text-white dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent dark:border-gray-700" href="/docs/">Docs</a></li><li><a class="block py-2 pl-3 pr-4 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:hover:text-blue-700 md:p-0 md:dark:hover:text-blue-500 dark:text-white dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent dark:border-gray-700" href="/articles/">Articles</a></li></ul></div><div class="flex items-center gap-3"><div class="hidden lg:flex items-center gap-3"><div class="hidden w-48 md:block"><div class="relative mt-1"><button class="relative w-full cursor-default rounded-lg bg-white dark:bg-gray-900 dark:text-white  py-2 pl-3 pr-10 text-left focus:outline-none focus-visible:border-indigo-500 focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75 focus-visible:ring-offset-2 sm:text-sm" id="headlessui-listbox-button-:Rcnj6:" type="button" aria-haspopup="listbox" aria-expanded="false" data-headlessui-state=""><span class="block truncate"></span><span class="pointer-events-none absolute inset-y-0 right-0 flex items-center pr-2"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" class="h-5 w-5 text-gray-400"><path fill-rule="evenodd" d="M10 3a.75.75 0 01.55.24l3.25 3.5a.75.75 0 11-1.1 1.02L10 4.852 7.3 7.76a.75.75 0 01-1.1-1.02l3.25-3.5A.75.75 0 0110 3zm-3.76 9.2a.75.75 0 011.06.04l2.7 2.908 2.7-2.908a.75.75 0 111.1 1.02l-3.25 3.5a.75.75 0 01-1.1 0l-3.25-3.5a.75.75 0 01.04-1.06z" clip-rule="evenodd"></path></svg></span></button></div></div><button type="button" class="flex h-6 w-6 items-center justify-center rounded-md transition hover:bg-zinc-900/5 dark:hover:bg-white/5" aria-label="Toggle dark mode"><svg viewBox="0 0 20 20" fill="none" aria-hidden="true" class="h-6 w-6 stroke-zinc-900 dark:hidden"><path d="M12.5 10a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0Z"></path><path stroke-linecap="round" d="M10 5.5v-1M13.182 6.818l.707-.707M14.5 10h1M13.182 13.182l.707.707M10 15.5v-1M6.11 13.889l.708-.707M4.5 10h1M6.11 6.111l.708.707"></path></svg><svg viewBox="0 0 20 20" fill="none" aria-hidden="true" class="hidden h-6 w-6 stroke-white dark:block"><path d="M15.224 11.724a5.5 5.5 0 0 1-6.949-6.949 5.5 5.5 0 1 0 6.949 6.949Z"></path></svg></button></div><button data-collapse-toggle="navbar-sticky" type="button" class="inline-flex items-center p-2 text-sm text-gray-500 rounded-lg md:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="navbar-sticky" aria-expanded="false"><span class="sr-only">Open main menu</span><svg class="w-6 h-6" aria-hidden="true" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg></button></div></div></div></nav></div></header><aside><div class="fixed top-28 left-0 w-full z-30 pointer-events-none hidden lg:block"><div class="w-full"><div class="max-w-screen-xl mx-auto"><div class="bg-white dark:bg-gray-900 contents lg:pointer-events-auto lg:block lg:w-72 lg:overflow-y-auto lg:px-6 lg:pb-8  xl:w-80 lg:border-r"><nav class="hidden lg:block"><ul role="list"><li class="relative mt-6 md:mt-0"><h2 class="text-xs font-semibold text-zinc-900 dark:text-white">Articles</h2><div class="relative mt-3 pl-2"><div class="absolute inset-x-0 top-0 bg-zinc-800/2.5 will-change-transform dark:bg-white/2.5" style="border-radius:8px;height:32px;top:192px;opacity:0"></div><div class="absolute inset-y-0 left-2 w-px bg-zinc-900/10 dark:bg-white/5"></div><div class="absolute left-2 h-6 w-px bg-primary-500" style="top:196px;opacity:1"></div><ul role="list" class="border-l border-transparent"><li class="relative"><a class="flex justify-between gap-2 py-1 pr-3 text-sm transition pl-4 text-zinc-600 hover:text-zinc-900 dark:text-zinc-400 dark:hover:text-white" href="/articles/the-issues-of-code-obfuscation/"><span class="truncate">代码混淆存在的问题</span></a></li><li class="relative"><a class="flex justify-between gap-2 py-1 pr-3 text-sm transition pl-4 text-zinc-600 hover:text-zinc-900 dark:text-zinc-400 dark:hover:text-white" href="/articles/the-issues-of-class-encryption/"><span class="truncate">Java类文件加密存在的问题</span></a></li><li class="relative"><a class="flex justify-between gap-2 py-1 pr-3 text-sm transition pl-4 text-zinc-600 hover:text-zinc-900 dark:text-zinc-400 dark:hover:text-white" href="/articles/the-issues-of-vm-protection/"><span class="truncate">虚拟化保护存在的问题</span></a></li><li class="relative"><a class="flex justify-between gap-2 py-1 pr-3 text-sm transition pl-4 text-zinc-600 hover:text-zinc-900 dark:text-zinc-400 dark:hover:text-white" href="/articles/the-issues-of-vm-protection/"><span class="truncate">AOT编译存在的问题</span></a></li><li class="relative"><a class="flex justify-between gap-2 py-1 pr-3 text-sm transition pl-4 text-zinc-600 hover:text-zinc-900 dark:text-zinc-400 dark:hover:text-white" href="/articles/deobfuscate-with-vlx-vmengine/"><span class="truncate">使用vlx-vmengine进行反混淆</span></a></li><li class="relative"><a class="flex justify-between gap-2 py-1 pr-3 text-sm transition pl-4 text-zinc-600 hover:text-zinc-900 dark:text-zinc-400 dark:hover:text-white" href="/articles/jvm-bytecode-engine-written-with-java-and-kotlin/"><span class="truncate">使用Java/Kotln编写的JVM字节码执行引擎</span></a></li><li class="relative"><a aria-current="page" class="flex justify-between gap-2 py-1 pr-3 text-sm transition pl-4 text-zinc-900 dark:text-white" href="/articles/graalvm-nativeimage-reverse-engineering/"><span class="truncate">GraalVM NativeImage Reverse Engineering</span></a><ul role="list" style="opacity:1"><li><a class="flex justify-between gap-2 py-1 pr-3 text-sm transition pl-7 text-zinc-600 hover:text-zinc-900 dark:text-zinc-400 dark:hover:text-white" href="/articles/graalvm-nativeimage-reverse-engineering/#"><span class="truncate">项目地址</span></a></li><li><a class="flex justify-between gap-2 py-1 pr-3 text-sm transition pl-7 text-zinc-600 hover:text-zinc-900 dark:text-zinc-400 dark:hover:text-white" href="/articles/graalvm-nativeimage-reverse-engineering/#native-image"><span class="truncate">生成NativeImage</span></a></li><li><a class="flex justify-between gap-2 py-1 pr-3 text-sm transition pl-7 text-zinc-600 hover:text-zinc-900 dark:text-zinc-400 dark:hover:text-white" href="/articles/graalvm-nativeimage-reverse-engineering/#native-image-2"><span class="truncate">分析NativeImage</span></a></li><li><a class="flex justify-between gap-2 py-1 pr-3 text-sm transition pl-7 text-zinc-600 hover:text-zinc-900 dark:text-zinc-400 dark:hover:text-white" href="/articles/graalvm-nativeimage-reverse-engineering/#"><span class="truncate">一个复杂点的程序</span></a></li><li><a class="flex justify-between gap-2 py-1 pr-3 text-sm transition pl-7 text-zinc-600 hover:text-zinc-900 dark:text-zinc-400 dark:hover:text-white" href="/articles/graalvm-nativeimage-reverse-engineering/#"><span class="truncate">还需要进一步完善的地方</span></a></li><li><a class="flex justify-between gap-2 py-1 pr-3 text-sm transition pl-7 text-zinc-600 hover:text-zinc-900 dark:text-zinc-400 dark:hover:text-white" href="/articles/graalvm-nativeimage-reverse-engineering/#"><span class="truncate">关于二进制保护的思考</span></a></li></ul></li><li class="relative"><a class="flex justify-between gap-2 py-1 pr-3 text-sm transition pl-4 text-zinc-600 hover:text-zinc-900 dark:text-zinc-400 dark:hover:text-white" href="/articles/cracking-encrypted-java-applications-jhsdb/"><span class="truncate">Cracking encrypted Java applications using jhsdb (hotspot debugger)</span></a></li><li class="relative"><a class="flex justify-between gap-2 py-1 pr-3 text-sm transition pl-4 text-zinc-600 hover:text-zinc-900 dark:text-zinc-400 dark:hover:text-white" href="/articles/extract-java-classes-information-from-aot/"><span class="truncate">Extract Java classes information from AOT compiled binary file</span></a></li><li class="relative"><a class="flex justify-between gap-2 py-1 pr-3 text-sm transition pl-4 text-zinc-600 hover:text-zinc-900 dark:text-zinc-400 dark:hover:text-white" href="/articles/what-is-jarx-file/"><span class="truncate">What is Jarx file</span></a></li><li class="relative"><a class="flex justify-between gap-2 py-1 pr-3 text-sm transition pl-4 text-zinc-600 hover:text-zinc-900 dark:text-zinc-400 dark:hover:text-white" href="/articles/protecting-java-source-code-beyond-obfuscation/"><span class="truncate">Protecting Java Source Code Beyond Obfuscation</span></a></li><li class="relative"><a class="flex justify-between gap-2 py-1 pr-3 text-sm transition pl-4 text-zinc-600 hover:text-zinc-900 dark:text-zinc-400 dark:hover:text-white" href="/articles/excelsior-jet-alternative/"><span class="truncate">Excelsior JET Alternative</span></a></li></ul></div></li><li class="sticky bottom-0 z-10 mt-6 min-[416px]:hidden"><a class="inline-flex gap-0.5 justify-center overflow-hidden text-sm font-medium transition rounded-full bg-zinc-900 py-1 px-3 text-white hover:bg-zinc-700 dark:bg-primary-500 dark:text-white dark:hover:bg-primary-400 w-full" href="/articles/graalvm-nativeimage-reverse-engineering/#">Sign in</a></li></ul></nav></div></div></div></div></aside><main class="py-28 dark:bg-gray-900"><div class="relative lg:left-60 mx-6" style="min-height:0"><article class="prose dark:prose-invert"><h1>GraalVM NativeImage 逆向还原</h1>
<p>Java代码还原与保护是一个老生常谈的问题，由于Java类文件的采取字节码格式保存，包含了许多元信息，所以可以很容易还原成原始代码。为了保护Java代码，业界采用了许多手段，比如混淆、字节码加密、JNI保护等等，但是无论哪种方法，都仍存在破解的方法和途径。</p>
<p>二进制编译，一直被认为是代码保护较为有效的一种方法，Java的二进制编译被撑为AOT技术(Ahead of Time)，即提前编译。</p>
<p>但是由于Java语言的动态特性，二进制编译需要处理反射、动态代理、JNI加载等问题，存在许多的困难，所以很长时间一来，Java的AOT编译方面一直缺乏一个成熟可靠、适应性强并且可大范围应用于生产环境的工具。（曾经有一个叫做ExcellisorJET，如今似乎已停止维护）</p>
<p>2019年5月，Oracle推出了GraalVM 19.0，一个多语言支持的虚拟机，19.0是它第一个面向生产环境的版本。GraalVM中提供了一个NativeImage工具，能够实现Java程序的AOT编译。经过几年的发展，目前NativeImage已经十分成熟，SpringBoot 3.0已经可以使用它将整个SpringBoot工程编译生成一个可执行文件，编译后的文件，启动速度快，内存占用低，具有非常好的效果。</p>
<p>那么，对于已经迎来二进制编译时代的Java程序来说，其代码是否仍是像字节码时代一样容易被逆向还原呢，NativeImage编译的二进制文件又有哪些特点，二进制编译的强度是否足够用来保护重要的代码？</p>
<p>为了探讨上述问题，笔者近期编写了一个NativeImage分析工具，已经能达到一定的逆向还原效果。</p>
<h2 id="" class="scroll-mt-24"><a class="group text-inherit no-underline hover:text-inherit" href="/articles/graalvm-nativeimage-reverse-engineering/#">项目地址</a></h2>
<p><a href="https://github.com/vlinx-io/NativeImageAnalyzer">https://github.com/vlinx-io/NativeImageAnalyzer</a></p>
<h2 id="native-image" class="scroll-mt-24"><a class="group text-inherit no-underline hover:text-inherit" href="/articles/graalvm-nativeimage-reverse-engineering/#native-image">生成NativeImage</a></h2>
<p>首先我们需要生成一个NativeImage，NativeImage来自于GraalVM，访问<a href="https://www.graalvm.org/">https://www.graalvm.org/</a> 下载Java 17版本，下载完成后设置好环境变量，GraalVM中同样包含了一个JDK，因此可以直接使用它执行Java命令.</p>
<p>添加$GRAALVM_HOME/bin到环境变量，之后执行</p>
<div class="not-prose my-6 overflow-hidden rounded-2xl bg-zinc-900 shadow-md dark:ring-1 dark:ring-white/10"><div class="group dark:bg-white/2.5"><div class="relative"><pre class="overflow-x-auto p-4 text-xs text-white"><code class="language-bash"><span><span style="color: var(--shiki-color-text)">gu install native-image</span></span>
<span></span></code></pre><button type="button" class="group/button absolute right-4 top-3.5 overflow-hidden rounded-full py-1 pl-2 pr-3 text-2xs font-medium opacity-0 backdrop-blur transition focus:opacity-100 group-hover:opacity-100 bg-white/5 hover:bg-white/7.5 dark:bg-white/2.5 dark:hover:bg-white/5"><span aria-hidden="false" class="pointer-events-none flex items-center gap-0.5 text-zinc-400 transition duration-300"><svg viewBox="0 0 20 20" aria-hidden="true" class="h-5 w-5 fill-zinc-500/20 stroke-zinc-500 transition-colors group-hover/button:stroke-zinc-400"><path stroke-width="0" d="M5.5 13.5v-5a2 2 0 0 1 2-2l.447-.894A2 2 0 0 1 9.737 4.5h.527a2 2 0 0 1 1.789 1.106l.447.894a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2Z"></path><path fill="none" stroke-linejoin="round" d="M12.5 6.5a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2m5 0-.447-.894a2 2 0 0 0-1.79-1.106h-.527a2 2 0 0 0-1.789 1.106L7.5 6.5m5 0-1 1h-3l-1-1"></path></svg>Copy</span><span aria-hidden="true" class="pointer-events-none absolute inset-0 flex items-center justify-center text-primary-400 transition duration-300 translate-y-1.5 opacity-0">Copied!</span></button></div></div></div>
<h3>编写一个简单Java程序</h3>
<p>编写一个简单的Java程序，例如</p>
<div class="not-prose my-6 overflow-hidden rounded-2xl bg-zinc-900 shadow-md dark:ring-1 dark:ring-white/10"><div class="group dark:bg-white/2.5"><div class="relative"><pre class="overflow-x-auto p-4 text-xs text-white"><code class="language-java"><span><span style="color: var(--shiki-token-keyword)">public</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">class</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Hello</span><span style="color: var(--shiki-color-text)"> {</span></span>
<span><span style="color: var(--shiki-color-text)">	</span><span style="color: var(--shiki-token-keyword)">public</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">static</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">void</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">main</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-keyword)">String</span><span style="color: var(--shiki-color-text)">[] args){</span></span>
<span><span style="color: var(--shiki-color-text)">		</span><span style="color: var(--shiki-token-constant)">System</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">out</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-function)">println</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">&quot;Hello World!&quot;</span><span style="color: var(--shiki-color-text)">);</span></span>
<span><span style="color: var(--shiki-color-text)">	}</span></span>
<span><span style="color: var(--shiki-color-text)">}</span></span>
<span></span></code></pre><button type="button" class="group/button absolute right-4 top-3.5 overflow-hidden rounded-full py-1 pl-2 pr-3 text-2xs font-medium opacity-0 backdrop-blur transition focus:opacity-100 group-hover:opacity-100 bg-white/5 hover:bg-white/7.5 dark:bg-white/2.5 dark:hover:bg-white/5"><span aria-hidden="false" class="pointer-events-none flex items-center gap-0.5 text-zinc-400 transition duration-300"><svg viewBox="0 0 20 20" aria-hidden="true" class="h-5 w-5 fill-zinc-500/20 stroke-zinc-500 transition-colors group-hover/button:stroke-zinc-400"><path stroke-width="0" d="M5.5 13.5v-5a2 2 0 0 1 2-2l.447-.894A2 2 0 0 1 9.737 4.5h.527a2 2 0 0 1 1.789 1.106l.447.894a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2Z"></path><path fill="none" stroke-linejoin="round" d="M12.5 6.5a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2m5 0-.447-.894a2 2 0 0 0-1.79-1.106h-.527a2 2 0 0 0-1.789 1.106L7.5 6.5m5 0-1 1h-3l-1-1"></path></svg>Copy</span><span aria-hidden="true" class="pointer-events-none absolute inset-0 flex items-center justify-center text-primary-400 transition duration-300 translate-y-1.5 opacity-0">Copied!</span></button></div></div></div>
<p>编译并运行上述Java程序</p>
<div class="not-prose my-6 overflow-hidden rounded-2xl bg-zinc-900 shadow-md dark:ring-1 dark:ring-white/10"><div class="group dark:bg-white/2.5"><div class="relative"><pre class="overflow-x-auto p-4 text-xs text-white"><code class="language-bash"><span><span style="color: var(--shiki-color-text)">javac Hello.java</span></span>
<span><span style="color: var(--shiki-color-text)">java -cp </span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-color-text)"> Hello</span></span>
<span></span></code></pre><button type="button" class="group/button absolute right-4 top-3.5 overflow-hidden rounded-full py-1 pl-2 pr-3 text-2xs font-medium opacity-0 backdrop-blur transition focus:opacity-100 group-hover:opacity-100 bg-white/5 hover:bg-white/7.5 dark:bg-white/2.5 dark:hover:bg-white/5"><span aria-hidden="false" class="pointer-events-none flex items-center gap-0.5 text-zinc-400 transition duration-300"><svg viewBox="0 0 20 20" aria-hidden="true" class="h-5 w-5 fill-zinc-500/20 stroke-zinc-500 transition-colors group-hover/button:stroke-zinc-400"><path stroke-width="0" d="M5.5 13.5v-5a2 2 0 0 1 2-2l.447-.894A2 2 0 0 1 9.737 4.5h.527a2 2 0 0 1 1.789 1.106l.447.894a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2Z"></path><path fill="none" stroke-linejoin="round" d="M12.5 6.5a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2m5 0-.447-.894a2 2 0 0 0-1.79-1.106h-.527a2 2 0 0 0-1.789 1.106L7.5 6.5m5 0-1 1h-3l-1-1"></path></svg>Copy</span><span aria-hidden="true" class="pointer-events-none absolute inset-0 flex items-center justify-center text-primary-400 transition duration-300 translate-y-1.5 opacity-0">Copied!</span></button></div></div></div>
<p>可以得到程序输出</p>
<div class="not-prose my-6 overflow-hidden rounded-2xl bg-zinc-900 shadow-md dark:ring-1 dark:ring-white/10"><div class="group dark:bg-white/2.5"><div class="relative"><pre class="overflow-x-auto p-4 text-xs text-white"><code>Hello World!
</code></pre><button type="button" class="group/button absolute right-4 top-3.5 overflow-hidden rounded-full py-1 pl-2 pr-3 text-2xs font-medium opacity-0 backdrop-blur transition focus:opacity-100 group-hover:opacity-100 bg-white/5 hover:bg-white/7.5 dark:bg-white/2.5 dark:hover:bg-white/5"><span aria-hidden="false" class="pointer-events-none flex items-center gap-0.5 text-zinc-400 transition duration-300"><svg viewBox="0 0 20 20" aria-hidden="true" class="h-5 w-5 fill-zinc-500/20 stroke-zinc-500 transition-colors group-hover/button:stroke-zinc-400"><path stroke-width="0" d="M5.5 13.5v-5a2 2 0 0 1 2-2l.447-.894A2 2 0 0 1 9.737 4.5h.527a2 2 0 0 1 1.789 1.106l.447.894a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2Z"></path><path fill="none" stroke-linejoin="round" d="M12.5 6.5a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2m5 0-.447-.894a2 2 0 0 0-1.79-1.106h-.527a2 2 0 0 0-1.789 1.106L7.5 6.5m5 0-1 1h-3l-1-1"></path></svg>Copy</span><span aria-hidden="true" class="pointer-events-none absolute inset-0 flex items-center justify-center text-primary-400 transition duration-300 translate-y-1.5 opacity-0">Copied!</span></button></div></div></div>
<h3>编译环境准备</h3>
<p>如果是Windows用户需要提前安装好Visual Studio, 如果是Linux与macOS用户，需要提前安装好gcc与clang等工具。</p>
<p>Windows用户在执行native-image命令之前，需要先设置好Visual Studio的环境变量，可以通过下述命令设置</p>
<div class="not-prose my-6 overflow-hidden rounded-2xl bg-zinc-900 shadow-md dark:ring-1 dark:ring-white/10"><div class="group dark:bg-white/2.5"><div class="relative"><pre class="overflow-x-auto p-4 text-xs text-white"><code> "C:\Program Files (x86)\Microsoft Visual Studio\2017\Community\VC\Auxiliary\Build\vcvars64.bat"
</code></pre><button type="button" class="group/button absolute right-4 top-3.5 overflow-hidden rounded-full py-1 pl-2 pr-3 text-2xs font-medium opacity-0 backdrop-blur transition focus:opacity-100 group-hover:opacity-100 bg-white/5 hover:bg-white/7.5 dark:bg-white/2.5 dark:hover:bg-white/5"><span aria-hidden="false" class="pointer-events-none flex items-center gap-0.5 text-zinc-400 transition duration-300"><svg viewBox="0 0 20 20" aria-hidden="true" class="h-5 w-5 fill-zinc-500/20 stroke-zinc-500 transition-colors group-hover/button:stroke-zinc-400"><path stroke-width="0" d="M5.5 13.5v-5a2 2 0 0 1 2-2l.447-.894A2 2 0 0 1 9.737 4.5h.527a2 2 0 0 1 1.789 1.106l.447.894a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2Z"></path><path fill="none" stroke-linejoin="round" d="M12.5 6.5a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2m5 0-.447-.894a2 2 0 0 0-1.79-1.106h-.527a2 2 0 0 0-1.789 1.106L7.5 6.5m5 0-1 1h-3l-1-1"></path></svg>Copy</span><span aria-hidden="true" class="pointer-events-none absolute inset-0 flex items-center justify-center text-primary-400 transition duration-300 translate-y-1.5 opacity-0">Copied!</span></button></div></div></div>
<p>如果Visual Studio的安装路径与版本不同，请自行调整相关路径信息。</p>
<h3>使用native-image进行编译</h3>
<p>现在使用native-image命令将上面这个Java程序编译成二进制文件, native-image命令的格式与java命令格式一致，同样有<code>-cp, -jar</code>这些参数，如何使用java命令来执行程序，就使用同样的方式进行二进制编译，只不过命令从java换成了native-image。执行命令如下</p>
<div class="not-prose my-6 overflow-hidden rounded-2xl bg-zinc-900 shadow-md dark:ring-1 dark:ring-white/10"><div class="group dark:bg-white/2.5"><div class="relative"><pre class="overflow-x-auto p-4 text-xs text-white"><code>native-image -cp . Hello
</code></pre><button type="button" class="group/button absolute right-4 top-3.5 overflow-hidden rounded-full py-1 pl-2 pr-3 text-2xs font-medium opacity-0 backdrop-blur transition focus:opacity-100 group-hover:opacity-100 bg-white/5 hover:bg-white/7.5 dark:bg-white/2.5 dark:hover:bg-white/5"><span aria-hidden="false" class="pointer-events-none flex items-center gap-0.5 text-zinc-400 transition duration-300"><svg viewBox="0 0 20 20" aria-hidden="true" class="h-5 w-5 fill-zinc-500/20 stroke-zinc-500 transition-colors group-hover/button:stroke-zinc-400"><path stroke-width="0" d="M5.5 13.5v-5a2 2 0 0 1 2-2l.447-.894A2 2 0 0 1 9.737 4.5h.527a2 2 0 0 1 1.789 1.106l.447.894a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2Z"></path><path fill="none" stroke-linejoin="round" d="M12.5 6.5a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2m5 0-.447-.894a2 2 0 0 0-1.79-1.106h-.527a2 2 0 0 0-1.789 1.106L7.5 6.5m5 0-1 1h-3l-1-1"></path></svg>Copy</span><span aria-hidden="true" class="pointer-events-none absolute inset-0 flex items-center justify-center text-primary-400 transition duration-300 translate-y-1.5 opacity-0">Copied!</span></button></div></div></div>
<p>经过一段时间的编译，期间可能会占用较多的CPU与内存，可以得到一个编译后的二进制文件，输出文件名默认为主类名的小写，此处为hello，如果是Windows下则为hello.exe，使用file命令来查看这个文件的类型，可以看到这确实是个二进制文件了</p>
<div class="not-prose my-6 overflow-hidden rounded-2xl bg-zinc-900 shadow-md dark:ring-1 dark:ring-white/10"><div class="group dark:bg-white/2.5"><div class="relative"><pre class="overflow-x-auto p-4 text-xs text-white"><code>file hello
hello: Mach-O 64-bit executable x86_64
</code></pre><button type="button" class="group/button absolute right-4 top-3.5 overflow-hidden rounded-full py-1 pl-2 pr-3 text-2xs font-medium opacity-0 backdrop-blur transition focus:opacity-100 group-hover:opacity-100 bg-white/5 hover:bg-white/7.5 dark:bg-white/2.5 dark:hover:bg-white/5"><span aria-hidden="false" class="pointer-events-none flex items-center gap-0.5 text-zinc-400 transition duration-300"><svg viewBox="0 0 20 20" aria-hidden="true" class="h-5 w-5 fill-zinc-500/20 stroke-zinc-500 transition-colors group-hover/button:stroke-zinc-400"><path stroke-width="0" d="M5.5 13.5v-5a2 2 0 0 1 2-2l.447-.894A2 2 0 0 1 9.737 4.5h.527a2 2 0 0 1 1.789 1.106l.447.894a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2Z"></path><path fill="none" stroke-linejoin="round" d="M12.5 6.5a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2m5 0-.447-.894a2 2 0 0 0-1.79-1.106h-.527a2 2 0 0 0-1.789 1.106L7.5 6.5m5 0-1 1h-3l-1-1"></path></svg>Copy</span><span aria-hidden="true" class="pointer-events-none absolute inset-0 flex items-center justify-center text-primary-400 transition duration-300 translate-y-1.5 opacity-0">Copied!</span></button></div></div></div>
<p>执行这个文件，其输出与前面使用<code>java -cp . Hello</code>的结果一致</p>
<div class="not-prose my-6 overflow-hidden rounded-2xl bg-zinc-900 shadow-md dark:ring-1 dark:ring-white/10"><div class="group dark:bg-white/2.5"><div class="relative"><pre class="overflow-x-auto p-4 text-xs text-white"><code>Hello World!
</code></pre><button type="button" class="group/button absolute right-4 top-3.5 overflow-hidden rounded-full py-1 pl-2 pr-3 text-2xs font-medium opacity-0 backdrop-blur transition focus:opacity-100 group-hover:opacity-100 bg-white/5 hover:bg-white/7.5 dark:bg-white/2.5 dark:hover:bg-white/5"><span aria-hidden="false" class="pointer-events-none flex items-center gap-0.5 text-zinc-400 transition duration-300"><svg viewBox="0 0 20 20" aria-hidden="true" class="h-5 w-5 fill-zinc-500/20 stroke-zinc-500 transition-colors group-hover/button:stroke-zinc-400"><path stroke-width="0" d="M5.5 13.5v-5a2 2 0 0 1 2-2l.447-.894A2 2 0 0 1 9.737 4.5h.527a2 2 0 0 1 1.789 1.106l.447.894a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2Z"></path><path fill="none" stroke-linejoin="round" d="M12.5 6.5a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2m5 0-.447-.894a2 2 0 0 0-1.79-1.106h-.527a2 2 0 0 0-1.789 1.106L7.5 6.5m5 0-1 1h-3l-1-1"></path></svg>Copy</span><span aria-hidden="true" class="pointer-events-none absolute inset-0 flex items-center justify-center text-primary-400 transition duration-300 translate-y-1.5 opacity-0">Copied!</span></button></div></div></div>
<h2 id="native-image-2" class="scroll-mt-24"><a class="group text-inherit no-underline hover:text-inherit" href="/articles/graalvm-nativeimage-reverse-engineering/#native-image-2">分析NativeImage</a></h2>
<h3>使用IDA进行分析</h3>
<p>使用IDA打开上面步骤编译的hello，点击Exports查看符号表，可以看到个svm_code_section符号，其地址就是Java Main函数的入口地址</p>
<p><img src="http://native-test.vlinx.io/resources/screenshots/image-20230218194013099.png" alt="image-20230218194013099"/></p>
<p>定位到这个地址，查看汇编代码</p>
<p><img src="http://native-test.vlinx.io/resources/screenshots/image-20230218194126014.png" alt="image-20230218194126014"/></p>
<p>可以看到已经是标准的汇编函数的样子了，使用F5进行反编译</p>
<p><img src="http://native-test.vlinx.io/resources/screenshots/image-20230218194235234.png" alt="image-20230218194235234"/></p>
<p>可以看到进行了一些函数调用 ，传递了一些参数，但是不容易看出逻辑。</p>
<p>我们双击sub_1000C0020，看看调用函数的内部，IDA提示分析失败</p>
<p><img src="http://native-test.vlinx.io/resources/screenshots/image-20230218194449494.png" alt="image-20230218194449494"/></p>
<h3>NativeImage 反编译的逻辑</h3>
<p>因为NativeImage的编译是基于JVM的编译，也可以理解为给二进码代码套了一层VM保护，所以IDA这类工具，在缺乏相应信息以及针对性处理措施的情况下，是无法很好的对其进行逆向还原的。</p>
<p>但是不论何种形式，以字节码的形式，还是以二进制的形式，JVM的执行的一些基本要素必然是存在的，例如类的信息，字段的信息，函数的调用与参数的传递等，基于这个思路，笔者编写的分析工具已能达到一定的还原效果，并且再加以完善的话，有能力达到足够高级别的还原度。</p>
<h3>使用NativeImageAnalyzer进行分析</h3>
<p>访问<a href="https://github.com/vlinx-io/NativeImageAnalyzer%E4%B8%8B%E8%BD%BDNativeImageAnalyzer">https://github.com/vlinx-io/NativeImageAnalyzer下载NativeImageAnalyzer</a></p>
<p>执行下述命令进行逆向分析，目前仅分析主类的Main函数</p>
<div class="not-prose my-6 overflow-hidden rounded-2xl bg-zinc-900 shadow-md dark:ring-1 dark:ring-white/10"><div class="group dark:bg-white/2.5"><div class="relative"><pre class="overflow-x-auto p-4 text-xs text-white"><code>native-image-analyzer hello
</code></pre><button type="button" class="group/button absolute right-4 top-3.5 overflow-hidden rounded-full py-1 pl-2 pr-3 text-2xs font-medium opacity-0 backdrop-blur transition focus:opacity-100 group-hover:opacity-100 bg-white/5 hover:bg-white/7.5 dark:bg-white/2.5 dark:hover:bg-white/5"><span aria-hidden="false" class="pointer-events-none flex items-center gap-0.5 text-zinc-400 transition duration-300"><svg viewBox="0 0 20 20" aria-hidden="true" class="h-5 w-5 fill-zinc-500/20 stroke-zinc-500 transition-colors group-hover/button:stroke-zinc-400"><path stroke-width="0" d="M5.5 13.5v-5a2 2 0 0 1 2-2l.447-.894A2 2 0 0 1 9.737 4.5h.527a2 2 0 0 1 1.789 1.106l.447.894a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2Z"></path><path fill="none" stroke-linejoin="round" d="M12.5 6.5a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2m5 0-.447-.894a2 2 0 0 0-1.79-1.106h-.527a2 2 0 0 0-1.789 1.106L7.5 6.5m5 0-1 1h-3l-1-1"></path></svg>Copy</span><span aria-hidden="true" class="pointer-events-none absolute inset-0 flex items-center justify-center text-primary-400 transition duration-300 translate-y-1.5 opacity-0">Copied!</span></button></div></div></div>
<p>得到输出如下</p>
<div class="not-prose my-6 overflow-hidden rounded-2xl bg-zinc-900 shadow-md dark:ring-1 dark:ring-white/10"><div class="group dark:bg-white/2.5"><div class="relative"><pre class="overflow-x-auto p-4 text-xs text-white"><code>java.io.PrintStream.writeln(java.io.PrintStream@0x554fe8, "Hello World!", rcx)
return
</code></pre><button type="button" class="group/button absolute right-4 top-3.5 overflow-hidden rounded-full py-1 pl-2 pr-3 text-2xs font-medium opacity-0 backdrop-blur transition focus:opacity-100 group-hover:opacity-100 bg-white/5 hover:bg-white/7.5 dark:bg-white/2.5 dark:hover:bg-white/5"><span aria-hidden="false" class="pointer-events-none flex items-center gap-0.5 text-zinc-400 transition duration-300"><svg viewBox="0 0 20 20" aria-hidden="true" class="h-5 w-5 fill-zinc-500/20 stroke-zinc-500 transition-colors group-hover/button:stroke-zinc-400"><path stroke-width="0" d="M5.5 13.5v-5a2 2 0 0 1 2-2l.447-.894A2 2 0 0 1 9.737 4.5h.527a2 2 0 0 1 1.789 1.106l.447.894a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2Z"></path><path fill="none" stroke-linejoin="round" d="M12.5 6.5a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2m5 0-.447-.894a2 2 0 0 0-1.79-1.106h-.527a2 2 0 0 0-1.789 1.106L7.5 6.5m5 0-1 1h-3l-1-1"></path></svg>Copy</span><span aria-hidden="true" class="pointer-events-none absolute inset-0 flex items-center justify-center text-primary-400 transition duration-300 translate-y-1.5 opacity-0">Copied!</span></button></div></div></div>
<p>我们再来看下原来的代码</p>
<div class="not-prose my-6 overflow-hidden rounded-2xl bg-zinc-900 shadow-md dark:ring-1 dark:ring-white/10"><div class="group dark:bg-white/2.5"><div class="relative"><pre class="overflow-x-auto p-4 text-xs text-white"><code>public static void main(String[] args){
		System.out.println("Hello World!");
}
</code></pre><button type="button" class="group/button absolute right-4 top-3.5 overflow-hidden rounded-full py-1 pl-2 pr-3 text-2xs font-medium opacity-0 backdrop-blur transition focus:opacity-100 group-hover:opacity-100 bg-white/5 hover:bg-white/7.5 dark:bg-white/2.5 dark:hover:bg-white/5"><span aria-hidden="false" class="pointer-events-none flex items-center gap-0.5 text-zinc-400 transition duration-300"><svg viewBox="0 0 20 20" aria-hidden="true" class="h-5 w-5 fill-zinc-500/20 stroke-zinc-500 transition-colors group-hover/button:stroke-zinc-400"><path stroke-width="0" d="M5.5 13.5v-5a2 2 0 0 1 2-2l.447-.894A2 2 0 0 1 9.737 4.5h.527a2 2 0 0 1 1.789 1.106l.447.894a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2Z"></path><path fill="none" stroke-linejoin="round" d="M12.5 6.5a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2m5 0-.447-.894a2 2 0 0 0-1.79-1.106h-.527a2 2 0 0 0-1.789 1.106L7.5 6.5m5 0-1 1h-3l-1-1"></path></svg>Copy</span><span aria-hidden="true" class="pointer-events-none absolute inset-0 flex items-center justify-center text-primary-400 transition duration-300 translate-y-1.5 opacity-0">Copied!</span></button></div></div></div>
<p>我们现在来看下System.out的定义</p>
<div class="not-prose my-6 overflow-hidden rounded-2xl bg-zinc-900 shadow-md dark:ring-1 dark:ring-white/10"><div class="group dark:bg-white/2.5"><div class="relative"><pre class="overflow-x-auto p-4 text-xs text-white"><code>public static final PrintStream out = null;
</code></pre><button type="button" class="group/button absolute right-4 top-3.5 overflow-hidden rounded-full py-1 pl-2 pr-3 text-2xs font-medium opacity-0 backdrop-blur transition focus:opacity-100 group-hover:opacity-100 bg-white/5 hover:bg-white/7.5 dark:bg-white/2.5 dark:hover:bg-white/5"><span aria-hidden="false" class="pointer-events-none flex items-center gap-0.5 text-zinc-400 transition duration-300"><svg viewBox="0 0 20 20" aria-hidden="true" class="h-5 w-5 fill-zinc-500/20 stroke-zinc-500 transition-colors group-hover/button:stroke-zinc-400"><path stroke-width="0" d="M5.5 13.5v-5a2 2 0 0 1 2-2l.447-.894A2 2 0 0 1 9.737 4.5h.527a2 2 0 0 1 1.789 1.106l.447.894a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2Z"></path><path fill="none" stroke-linejoin="round" d="M12.5 6.5a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2m5 0-.447-.894a2 2 0 0 0-1.79-1.106h-.527a2 2 0 0 0-1.789 1.106L7.5 6.5m5 0-1 1h-3l-1-1"></path></svg>Copy</span><span aria-hidden="true" class="pointer-events-none absolute inset-0 flex items-center justify-center text-primary-400 transition duration-300 translate-y-1.5 opacity-0">Copied!</span></button></div></div></div>
<p>可以看到System类的out变量是一个PrintStream类型的变量，并且是一个静态变量，NativeImage在编译的时候直接将这个类的实例编译到一个叫做Heap的区域，二进制代码直接从Heap区域获取这个类的实例进行调用，我们再来看下还原后的代码</p>
<div class="not-prose my-6 overflow-hidden rounded-2xl bg-zinc-900 shadow-md dark:ring-1 dark:ring-white/10"><div class="group dark:bg-white/2.5"><div class="relative"><pre class="overflow-x-auto p-4 text-xs text-white"><code>java.io.PrintStream.writeln(java.io.PrintStream@0x554fe8, "Hello World!", rcx)
return
</code></pre><button type="button" class="group/button absolute right-4 top-3.5 overflow-hidden rounded-full py-1 pl-2 pr-3 text-2xs font-medium opacity-0 backdrop-blur transition focus:opacity-100 group-hover:opacity-100 bg-white/5 hover:bg-white/7.5 dark:bg-white/2.5 dark:hover:bg-white/5"><span aria-hidden="false" class="pointer-events-none flex items-center gap-0.5 text-zinc-400 transition duration-300"><svg viewBox="0 0 20 20" aria-hidden="true" class="h-5 w-5 fill-zinc-500/20 stroke-zinc-500 transition-colors group-hover/button:stroke-zinc-400"><path stroke-width="0" d="M5.5 13.5v-5a2 2 0 0 1 2-2l.447-.894A2 2 0 0 1 9.737 4.5h.527a2 2 0 0 1 1.789 1.106l.447.894a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2Z"></path><path fill="none" stroke-linejoin="round" d="M12.5 6.5a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2m5 0-.447-.894a2 2 0 0 0-1.79-1.106h-.527a2 2 0 0 0-1.789 1.106L7.5 6.5m5 0-1 1h-3l-1-1"></path></svg>Copy</span><span aria-hidden="true" class="pointer-events-none absolute inset-0 flex items-center justify-center text-primary-400 transition duration-300 translate-y-1.5 opacity-0">Copied!</span></button></div></div></div>
<p>这里的<code>java.io.PrintStream@0x554fe8</code> 就是从Heap区域中读出的<code>java.io.PrintStream</code>的实例变量，其在内存中的地址为0x554fe8</p>
<p>我们再来看下<code>java.io.PrintStream.writeln</code> 函数的定义</p>
<div class="not-prose my-6 overflow-hidden rounded-2xl bg-zinc-900 shadow-md dark:ring-1 dark:ring-white/10"><div class="group dark:bg-white/2.5"><div class="relative"><pre class="overflow-x-auto p-4 text-xs text-white"><code>private void writeln(String s) {
		......        
}
</code></pre><button type="button" class="group/button absolute right-4 top-3.5 overflow-hidden rounded-full py-1 pl-2 pr-3 text-2xs font-medium opacity-0 backdrop-blur transition focus:opacity-100 group-hover:opacity-100 bg-white/5 hover:bg-white/7.5 dark:bg-white/2.5 dark:hover:bg-white/5"><span aria-hidden="false" class="pointer-events-none flex items-center gap-0.5 text-zinc-400 transition duration-300"><svg viewBox="0 0 20 20" aria-hidden="true" class="h-5 w-5 fill-zinc-500/20 stroke-zinc-500 transition-colors group-hover/button:stroke-zinc-400"><path stroke-width="0" d="M5.5 13.5v-5a2 2 0 0 1 2-2l.447-.894A2 2 0 0 1 9.737 4.5h.527a2 2 0 0 1 1.789 1.106l.447.894a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2Z"></path><path fill="none" stroke-linejoin="round" d="M12.5 6.5a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2m5 0-.447-.894a2 2 0 0 0-1.79-1.106h-.527a2 2 0 0 0-1.789 1.106L7.5 6.5m5 0-1 1h-3l-1-1"></path></svg>Copy</span><span aria-hidden="true" class="pointer-events-none absolute inset-0 flex items-center justify-center text-primary-400 transition duration-300 translate-y-1.5 opacity-0">Copied!</span></button></div></div></div>
<p>我们这里可以看到writelin函数中有一个String类型的参数，而还原的代码中为什么传递了三个参数了，首先<code>writeln</code>是一个类成员方法，只默认隐藏了一个<code>this</code>变量指向调用者，即传递的第一个参数<code>java.io.PrintStream@0x554fe8</code>，至于第三个参数rcx，是因为在进行汇编代码分析的过程中判断这个函数调用了三个参数，但实际上看定义我们知道这个函数实只调用两个参数，这也是本工具后续需要改进的地方。</p>
<h2 id="" class="scroll-mt-24"><a class="group text-inherit no-underline hover:text-inherit" href="/articles/graalvm-nativeimage-reverse-engineering/#">一个复杂点的程序</a></h2>
<p>我们接下来分析一个复杂点的程序，比如计算一个Fibonacci数列，代码如下</p>
<div class="not-prose my-6 overflow-hidden rounded-2xl bg-zinc-900 shadow-md dark:ring-1 dark:ring-white/10"><div class="group dark:bg-white/2.5"><div class="relative"><pre class="overflow-x-auto p-4 text-xs text-white"><code class="language-java"><span><span style="color: var(--shiki-token-keyword)">class</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Fibonacci</span><span style="color: var(--shiki-color-text)"> {</span></span>
<span><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">public</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">static</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">void</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">main</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-keyword)">String</span><span style="color: var(--shiki-color-text)">[] args) {</span></span>
<span><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-keyword)">int</span><span style="color: var(--shiki-color-text)"> count </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">Integer</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-function)">parseInt</span><span style="color: var(--shiki-color-text)">(args[</span><span style="color: var(--shiki-token-constant)">0</span><span style="color: var(--shiki-color-text)">]);</span></span>
<span></span>
<span><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-keyword)">int</span><span style="color: var(--shiki-color-text)"> n1 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">0</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> n2 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> n3;</span></span>
<span><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-constant)">System</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">out</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-function)">print</span><span style="color: var(--shiki-color-text)">(n1 </span><span style="color: var(--shiki-token-keyword)">+</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&quot; &quot;</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">+</span><span style="color: var(--shiki-color-text)"> n2);</span></span>
<span></span>
<span><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-keyword)">for</span><span style="color: var(--shiki-color-text)"> (</span><span style="color: var(--shiki-token-keyword)">int</span><span style="color: var(--shiki-color-text)"> i </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">2</span><span style="color: var(--shiki-color-text)">; i </span><span style="color: var(--shiki-token-keyword)">&amp;</span><span style="color: var(--shiki-color-text)">lt; count; </span><span style="color: var(--shiki-token-keyword)">++</span><span style="color: var(--shiki-color-text)">i){</span></span>
<span><span style="color: var(--shiki-color-text)">            n3 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> n1 </span><span style="color: var(--shiki-token-keyword)">+</span><span style="color: var(--shiki-color-text)"> n2;</span></span>
<span><span style="color: var(--shiki-color-text)">            </span><span style="color: var(--shiki-token-constant)">System</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">out</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-function)">print</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">&quot; &quot;</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">+</span><span style="color: var(--shiki-color-text)"> n3);</span></span>
<span><span style="color: var(--shiki-color-text)">            n1 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> n2;</span></span>
<span><span style="color: var(--shiki-color-text)">            n2 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> n3;</span></span>
<span><span style="color: var(--shiki-color-text)">        }</span></span>
<span><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-constant)">System</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">out</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-function)">println</span><span style="color: var(--shiki-color-text)">();</span></span>
<span><span style="color: var(--shiki-color-text)">    }</span></span>
<span><span style="color: var(--shiki-color-text)">}</span></span>
<span></span></code></pre><button type="button" class="group/button absolute right-4 top-3.5 overflow-hidden rounded-full py-1 pl-2 pr-3 text-2xs font-medium opacity-0 backdrop-blur transition focus:opacity-100 group-hover:opacity-100 bg-white/5 hover:bg-white/7.5 dark:bg-white/2.5 dark:hover:bg-white/5"><span aria-hidden="false" class="pointer-events-none flex items-center gap-0.5 text-zinc-400 transition duration-300"><svg viewBox="0 0 20 20" aria-hidden="true" class="h-5 w-5 fill-zinc-500/20 stroke-zinc-500 transition-colors group-hover/button:stroke-zinc-400"><path stroke-width="0" d="M5.5 13.5v-5a2 2 0 0 1 2-2l.447-.894A2 2 0 0 1 9.737 4.5h.527a2 2 0 0 1 1.789 1.106l.447.894a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2Z"></path><path fill="none" stroke-linejoin="round" d="M12.5 6.5a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2m5 0-.447-.894a2 2 0 0 0-1.79-1.106h-.527a2 2 0 0 0-1.789 1.106L7.5 6.5m5 0-1 1h-3l-1-1"></path></svg>Copy</span><span aria-hidden="true" class="pointer-events-none absolute inset-0 flex items-center justify-center text-primary-400 transition duration-300 translate-y-1.5 opacity-0">Copied!</span></button></div></div></div>
<p>编译并执行</p>
<div class="not-prose my-6 overflow-hidden rounded-2xl bg-zinc-900 shadow-md dark:ring-1 dark:ring-white/10"><div class="group dark:bg-white/2.5"><div class="relative"><pre class="overflow-x-auto p-4 text-xs text-white"><code class="language-bash"><span><span style="color: var(--shiki-color-text)">javac Fibonacci.java</span></span>
<span><span style="color: var(--shiki-color-text)">native-image -cp </span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-color-text)"> Fibonacci</span></span>
<span><span style="color: var(--shiki-color-text)">./fibonacci 10</span></span>
<span><span style="color: var(--shiki-color-text)">0 1 1 2 3 5 8 13 21 34</span></span>
<span></span></code></pre><button type="button" class="group/button absolute right-4 top-3.5 overflow-hidden rounded-full py-1 pl-2 pr-3 text-2xs font-medium opacity-0 backdrop-blur transition focus:opacity-100 group-hover:opacity-100 bg-white/5 hover:bg-white/7.5 dark:bg-white/2.5 dark:hover:bg-white/5"><span aria-hidden="false" class="pointer-events-none flex items-center gap-0.5 text-zinc-400 transition duration-300"><svg viewBox="0 0 20 20" aria-hidden="true" class="h-5 w-5 fill-zinc-500/20 stroke-zinc-500 transition-colors group-hover/button:stroke-zinc-400"><path stroke-width="0" d="M5.5 13.5v-5a2 2 0 0 1 2-2l.447-.894A2 2 0 0 1 9.737 4.5h.527a2 2 0 0 1 1.789 1.106l.447.894a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2Z"></path><path fill="none" stroke-linejoin="round" d="M12.5 6.5a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2m5 0-.447-.894a2 2 0 0 0-1.79-1.106h-.527a2 2 0 0 0-1.789 1.106L7.5 6.5m5 0-1 1h-3l-1-1"></path></svg>Copy</span><span aria-hidden="true" class="pointer-events-none absolute inset-0 flex items-center justify-center text-primary-400 transition duration-300 translate-y-1.5 opacity-0">Copied!</span></button></div></div></div>
<p>使用NativeImageAnalyzer还原后获得代码如下</p>
<div class="not-prose my-6 overflow-hidden rounded-2xl bg-zinc-900 shadow-md dark:ring-1 dark:ring-white/10"><div class="group dark:bg-white/2.5"><div class="relative"><pre class="overflow-x-auto p-4 text-xs text-white"><code class="language-java"><span><span style="color: var(--shiki-color-text)">rdi </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> rdi[</span><span style="color: var(--shiki-token-constant)">0</span><span style="color: var(--shiki-color-text)">]</span></span>
<span><span style="color: var(--shiki-color-text)">ret_0 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">java</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">lang</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">Integer</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-function)">parseInt</span><span style="color: var(--shiki-color-text)">(rdi</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">10</span><span style="color: var(--shiki-color-text)">)</span></span>
<span><span style="color: var(--shiki-color-text)">sp_0x44 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> ret_0</span></span>
<span><span style="color: var(--shiki-color-text)">ret_1 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">java</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">lang</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">StringConcatHelper</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-function)">mix</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-color-text)">)</span></span>
<span><span style="color: var(--shiki-color-text)">ret_2 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">java</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">lang</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">StringConcatHelper</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-function)">mix</span><span style="color: var(--shiki-color-text)">(ret_1</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">0</span><span style="color: var(--shiki-color-text)">)</span></span>
<span><span style="color: var(--shiki-color-text)">sp_0x20 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">java</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">io</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">PrintStream</span><span style="color: var(--shiki-color-text)">@</span><span style="color: var(--shiki-token-keyword)">0x554fe8</span></span>
<span><span style="color: var(--shiki-color-text)">sp_0x18 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> Class{[B}</span><span style="color: var(--shiki-token-keyword)">_1</span></span>
<span><span style="color: var(--shiki-color-text)">tlab_0 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> Class{[B}</span><span style="color: var(--shiki-token-keyword)">_1</span></span>
<span><span style="color: var(--shiki-token-constant)">tlab_0</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">length</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> ret_2</span><span style="color: var(--shiki-token-keyword)">&amp;</span><span style="color: var(--shiki-color-text)">lt;</span><span style="color: var(--shiki-token-keyword)">&amp;</span><span style="color: var(--shiki-color-text)">lt;ret_2</span><span style="color: var(--shiki-token-keyword)">&amp;</span><span style="color: var(--shiki-color-text)">gt;</span><span style="color: var(--shiki-token-keyword)">&amp;</span><span style="color: var(--shiki-color-text)">gt;</span><span style="color: var(--shiki-token-constant)">32</span></span>
<span><span style="color: var(--shiki-color-text)">sp_0x10 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> tlab_0</span></span>
<span><span style="color: var(--shiki-color-text)">ret_28 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">?</span><span style="color: var(--shiki-token-constant)">java</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">lang</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">StringConcatHelper</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-function)">prepend</span><span style="color: var(--shiki-color-text)">(tlab_0</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&quot; &quot;</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> ret_2)</span></span>
<span><span style="color: var(--shiki-color-text)">ret_29 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">java</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">lang</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">StringConcatHelper</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-function)">prepend</span><span style="color: var(--shiki-color-text)">(ret_28</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> sp_0x10</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">0</span><span style="color: var(--shiki-color-text)">)</span></span>
<span><span style="color: var(--shiki-color-text)">ret_30 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">?</span><span style="color: var(--shiki-token-constant)">java</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">lang</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">StringConcatHelper</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-function)">newString</span><span style="color: var(--shiki-color-text)">(sp_0x10</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> ret_29)</span></span>
<span><span style="color: var(--shiki-token-constant)">java</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">io</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">PrintStream</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-function)">write</span><span style="color: var(--shiki-color-text)">(sp_0x20</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> ret_30)</span></span>
<span><span style="color: var(--shiki-token-keyword)">if</span><span style="color: var(--shiki-color-text)">(sp_0x44</span><span style="color: var(--shiki-token-keyword)">&amp;</span><span style="color: var(--shiki-color-text)">gt;</span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-token-constant)">3</span><span style="color: var(--shiki-color-text)">)</span></span>
<span><span style="color: var(--shiki-color-text)">{</span></span>
<span><span style="color: var(--shiki-color-text)">	ret_7 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">java</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">lang</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">StringConcatHelper</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-function)">mix</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-color-text)">)</span></span>
<span><span style="color: var(--shiki-color-text)">	tlab_1 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> sp_0x18</span></span>
<span><span style="color: var(--shiki-color-text)">	</span><span style="color: var(--shiki-token-constant)">tlab_1</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">length</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> ret_7</span><span style="color: var(--shiki-token-keyword)">&amp;</span><span style="color: var(--shiki-color-text)">lt;</span><span style="color: var(--shiki-token-keyword)">&amp;</span><span style="color: var(--shiki-color-text)">lt;ret_7</span><span style="color: var(--shiki-token-keyword)">&amp;</span><span style="color: var(--shiki-color-text)">gt;</span><span style="color: var(--shiki-token-keyword)">&amp;</span><span style="color: var(--shiki-color-text)">gt;</span><span style="color: var(--shiki-token-constant)">32</span></span>
<span><span style="color: var(--shiki-color-text)">	sp_0x10 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&quot; &quot;</span></span>
<span><span style="color: var(--shiki-color-text)">	sp_0x8 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> tlab_1</span></span>
<span><span style="color: var(--shiki-color-text)">	ret_22 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">?</span><span style="color: var(--shiki-token-constant)">java</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">lang</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">StringConcatHelper</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-function)">prepend</span><span style="color: var(--shiki-color-text)">(tlab_1</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&quot; &quot;</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> ret_7)</span></span>
<span><span style="color: var(--shiki-color-text)">	ret_23 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">?</span><span style="color: var(--shiki-token-constant)">java</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">lang</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">StringConcatHelper</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-function)">newString</span><span style="color: var(--shiki-color-text)">(sp_0x8</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> ret_22)</span></span>
<span><span style="color: var(--shiki-color-text)">	rsi </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> ret_23</span></span>
<span><span style="color: var(--shiki-color-text)">	</span><span style="color: var(--shiki-token-constant)">java</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">io</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">PrintStream</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-function)">write</span><span style="color: var(--shiki-color-text)">(sp_0x20</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> ret_23)</span></span>
<span><span style="color: var(--shiki-color-text)">	rdi </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">1</span></span>
<span><span style="color: var(--shiki-color-text)">	rdx </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">1</span></span>
<span><span style="color: var(--shiki-color-text)">	rcx </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">3</span></span>
<span><span style="color: var(--shiki-color-text)">	</span><span style="color: var(--shiki-token-keyword)">while</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">true</span><span style="color: var(--shiki-color-text)">)</span></span>
<span><span style="color: var(--shiki-color-text)">	{</span></span>
<span><span style="color: var(--shiki-color-text)">		</span><span style="color: var(--shiki-token-keyword)">if</span><span style="color: var(--shiki-color-text)">(sp_0x44</span><span style="color: var(--shiki-token-keyword)">&amp;</span><span style="color: var(--shiki-color-text)">lt;</span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)">rcx)</span></span>
<span><span style="color: var(--shiki-color-text)">		{</span></span>
<span><span style="color: var(--shiki-color-text)">			</span><span style="color: var(--shiki-token-keyword)">break</span></span>
<span><span style="color: var(--shiki-color-text)">		}</span></span>
<span><span style="color: var(--shiki-color-text)">		</span><span style="color: var(--shiki-token-keyword)">else</span></span>
<span><span style="color: var(--shiki-color-text)">		{</span></span>
<span><span style="color: var(--shiki-color-text)">			sp_0x34 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> rcx</span></span>
<span><span style="color: var(--shiki-color-text)">			rdi </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> rdi</span><span style="color: var(--shiki-token-keyword)">+</span><span style="color: var(--shiki-color-text)">rdx</span></span>
<span><span style="color: var(--shiki-color-text)">			r9 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> rdi</span></span>
<span><span style="color: var(--shiki-color-text)">			sp_0x30 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> rdx</span></span>
<span><span style="color: var(--shiki-color-text)">			sp_0x2c </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> r9</span></span>
<span><span style="color: var(--shiki-color-text)">			ret_11 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">java</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">lang</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">StringConcatHelper</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-function)">mix</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> r9)</span></span>
<span><span style="color: var(--shiki-color-text)">			tlab_2 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> sp_0x18</span></span>
<span><span style="color: var(--shiki-color-text)">			</span><span style="color: var(--shiki-token-constant)">tlab_2</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">length</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> ret_11</span><span style="color: var(--shiki-token-keyword)">&amp;</span><span style="color: var(--shiki-color-text)">lt;</span><span style="color: var(--shiki-token-keyword)">&amp;</span><span style="color: var(--shiki-color-text)">lt;ret_11</span><span style="color: var(--shiki-token-keyword)">&amp;</span><span style="color: var(--shiki-color-text)">gt;</span><span style="color: var(--shiki-token-keyword)">&amp;</span><span style="color: var(--shiki-color-text)">gt;</span><span style="color: var(--shiki-token-constant)">32</span></span>
<span><span style="color: var(--shiki-color-text)">			sp_0x8 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> tlab_2</span></span>
<span><span style="color: var(--shiki-color-text)">			ret_17 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">?</span><span style="color: var(--shiki-token-constant)">java</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">lang</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">StringConcatHelper</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-function)">prepend</span><span style="color: var(--shiki-color-text)">(tlab_2</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> sp_0x10</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> ret_11)</span></span>
<span><span style="color: var(--shiki-color-text)">			ret_18 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">?</span><span style="color: var(--shiki-token-constant)">java</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">lang</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">StringConcatHelper</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-function)">newString</span><span style="color: var(--shiki-color-text)">(sp_0x8</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> ret_17)</span></span>
<span><span style="color: var(--shiki-color-text)">			rsi </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> ret_18</span></span>
<span><span style="color: var(--shiki-color-text)">			</span><span style="color: var(--shiki-token-constant)">java</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">io</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">PrintStream</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-function)">write</span><span style="color: var(--shiki-color-text)">(sp_0x20</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> ret_18)</span></span>
<span><span style="color: var(--shiki-color-text)">			rcx </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> sp_0x34</span><span style="color: var(--shiki-token-keyword)">+</span><span style="color: var(--shiki-token-constant)">1</span></span>
<span><span style="color: var(--shiki-color-text)">			rdi </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> sp_0x30</span></span>
<span><span style="color: var(--shiki-color-text)">			rdx </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> sp_0x2c</span></span>
<span><span style="color: var(--shiki-color-text)">		}</span></span>
<span><span style="color: var(--shiki-color-text)">	}</span></span>
<span><span style="color: var(--shiki-color-text)">}</span></span>
<span><span style="color: var(--shiki-token-constant)">java</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">io</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">PrintStream</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-function)">newLine</span><span style="color: var(--shiki-color-text)">(sp_0x20</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> rsi)</span></span>
<span><span style="color: var(--shiki-token-keyword)">return</span></span>
<span></span></code></pre><button type="button" class="group/button absolute right-4 top-3.5 overflow-hidden rounded-full py-1 pl-2 pr-3 text-2xs font-medium opacity-0 backdrop-blur transition focus:opacity-100 group-hover:opacity-100 bg-white/5 hover:bg-white/7.5 dark:bg-white/2.5 dark:hover:bg-white/5"><span aria-hidden="false" class="pointer-events-none flex items-center gap-0.5 text-zinc-400 transition duration-300"><svg viewBox="0 0 20 20" aria-hidden="true" class="h-5 w-5 fill-zinc-500/20 stroke-zinc-500 transition-colors group-hover/button:stroke-zinc-400"><path stroke-width="0" d="M5.5 13.5v-5a2 2 0 0 1 2-2l.447-.894A2 2 0 0 1 9.737 4.5h.527a2 2 0 0 1 1.789 1.106l.447.894a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2Z"></path><path fill="none" stroke-linejoin="round" d="M12.5 6.5a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2m5 0-.447-.894a2 2 0 0 0-1.79-1.106h-.527a2 2 0 0 0-1.789 1.106L7.5 6.5m5 0-1 1h-3l-1-1"></path></svg>Copy</span><span aria-hidden="true" class="pointer-events-none absolute inset-0 flex items-center justify-center text-primary-400 transition duration-300 translate-y-1.5 opacity-0">Copied!</span></button></div></div></div>
<p>把还原后的代码与原代码比较下</p>
<div class="not-prose my-6 overflow-hidden rounded-2xl bg-zinc-900 shadow-md dark:ring-1 dark:ring-white/10"><div class="group dark:bg-white/2.5"><div class="relative"><pre class="overflow-x-auto p-4 text-xs text-white"><code class="language-java"><span><span style="color: var(--shiki-color-text)">rdi </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> rdi[</span><span style="color: var(--shiki-token-constant)">0</span><span style="color: var(--shiki-color-text)">]</span></span>
<span><span style="color: var(--shiki-color-text)">ret_0 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">java</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">lang</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">Integer</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-function)">parseInt</span><span style="color: var(--shiki-color-text)">(rdi</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">10</span><span style="color: var(--shiki-color-text)">)</span></span>
<span><span style="color: var(--shiki-color-text)">sp_0x44 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> ret_0</span></span>
<span></span></code></pre><button type="button" class="group/button absolute right-4 top-3.5 overflow-hidden rounded-full py-1 pl-2 pr-3 text-2xs font-medium opacity-0 backdrop-blur transition focus:opacity-100 group-hover:opacity-100 bg-white/5 hover:bg-white/7.5 dark:bg-white/2.5 dark:hover:bg-white/5"><span aria-hidden="false" class="pointer-events-none flex items-center gap-0.5 text-zinc-400 transition duration-300"><svg viewBox="0 0 20 20" aria-hidden="true" class="h-5 w-5 fill-zinc-500/20 stroke-zinc-500 transition-colors group-hover/button:stroke-zinc-400"><path stroke-width="0" d="M5.5 13.5v-5a2 2 0 0 1 2-2l.447-.894A2 2 0 0 1 9.737 4.5h.527a2 2 0 0 1 1.789 1.106l.447.894a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2Z"></path><path fill="none" stroke-linejoin="round" d="M12.5 6.5a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2m5 0-.447-.894a2 2 0 0 0-1.79-1.106h-.527a2 2 0 0 0-1.789 1.106L7.5 6.5m5 0-1 1h-3l-1-1"></path></svg>Copy</span><span aria-hidden="true" class="pointer-events-none absolute inset-0 flex items-center justify-center text-primary-400 transition duration-300 translate-y-1.5 opacity-0">Copied!</span></button></div></div></div>
<p>对应的是</p>
<div class="not-prose my-6 overflow-hidden rounded-2xl bg-zinc-900 shadow-md dark:ring-1 dark:ring-white/10"><div class="group dark:bg-white/2.5"><div class="relative"><pre class="overflow-x-auto p-4 text-xs text-white"><code> int count = Integer.parseInt(args[0]);
</code></pre><button type="button" class="group/button absolute right-4 top-3.5 overflow-hidden rounded-full py-1 pl-2 pr-3 text-2xs font-medium opacity-0 backdrop-blur transition focus:opacity-100 group-hover:opacity-100 bg-white/5 hover:bg-white/7.5 dark:bg-white/2.5 dark:hover:bg-white/5"><span aria-hidden="false" class="pointer-events-none flex items-center gap-0.5 text-zinc-400 transition duration-300"><svg viewBox="0 0 20 20" aria-hidden="true" class="h-5 w-5 fill-zinc-500/20 stroke-zinc-500 transition-colors group-hover/button:stroke-zinc-400"><path stroke-width="0" d="M5.5 13.5v-5a2 2 0 0 1 2-2l.447-.894A2 2 0 0 1 9.737 4.5h.527a2 2 0 0 1 1.789 1.106l.447.894a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2Z"></path><path fill="none" stroke-linejoin="round" d="M12.5 6.5a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2m5 0-.447-.894a2 2 0 0 0-1.79-1.106h-.527a2 2 0 0 0-1.789 1.106L7.5 6.5m5 0-1 1h-3l-1-1"></path></svg>Copy</span><span aria-hidden="true" class="pointer-events-none absolute inset-0 flex items-center justify-center text-primary-400 transition duration-300 translate-y-1.5 opacity-0">Copied!</span></button></div></div></div>
<p>rdi是用来传递函数的第一个参数的寄存器，如果在Windows下则是rdx，rdi=rdi[0]<code>即对应了</code>args[0]<code>，之后调用</code>java.lang.Integer.parseInt<code>解析获得一个int数值，然后将返回值赋值给一个栈上变量</code>sp_0x44</p>
<div class="not-prose my-6 overflow-hidden rounded-2xl bg-zinc-900 shadow-md dark:ring-1 dark:ring-white/10"><div class="group dark:bg-white/2.5"><div class="relative"><pre class="overflow-x-auto p-4 text-xs text-white"><code class="language-java"><span><span style="color: var(--shiki-token-keyword)">int</span><span style="color: var(--shiki-color-text)"> n1 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">0</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> n2 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> n3;</span></span>
<span><span style="color: var(--shiki-token-constant)">System</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">out</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-function)">print</span><span style="color: var(--shiki-color-text)">(n1 </span><span style="color: var(--shiki-token-keyword)">+</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&quot; &quot;</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">+</span><span style="color: var(--shiki-color-text)"> n2);</span></span>
<span></span></code></pre><button type="button" class="group/button absolute right-4 top-3.5 overflow-hidden rounded-full py-1 pl-2 pr-3 text-2xs font-medium opacity-0 backdrop-blur transition focus:opacity-100 group-hover:opacity-100 bg-white/5 hover:bg-white/7.5 dark:bg-white/2.5 dark:hover:bg-white/5"><span aria-hidden="false" class="pointer-events-none flex items-center gap-0.5 text-zinc-400 transition duration-300"><svg viewBox="0 0 20 20" aria-hidden="true" class="h-5 w-5 fill-zinc-500/20 stroke-zinc-500 transition-colors group-hover/button:stroke-zinc-400"><path stroke-width="0" d="M5.5 13.5v-5a2 2 0 0 1 2-2l.447-.894A2 2 0 0 1 9.737 4.5h.527a2 2 0 0 1 1.789 1.106l.447.894a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2Z"></path><path fill="none" stroke-linejoin="round" d="M12.5 6.5a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2m5 0-.447-.894a2 2 0 0 0-1.79-1.106h-.527a2 2 0 0 0-1.789 1.106L7.5 6.5m5 0-1 1h-3l-1-1"></path></svg>Copy</span><span aria-hidden="true" class="pointer-events-none absolute inset-0 flex items-center justify-center text-primary-400 transition duration-300 translate-y-1.5 opacity-0">Copied!</span></button></div></div></div>
<p>对应的是</p>
<div class="not-prose my-6 overflow-hidden rounded-2xl bg-zinc-900 shadow-md dark:ring-1 dark:ring-white/10"><div class="group dark:bg-white/2.5"><div class="relative"><pre class="overflow-x-auto p-4 text-xs text-white"><code class="language-java"><span><span style="color: var(--shiki-color-text)">ret_1 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">java</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">lang</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">StringConcatHelper</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-function)">mix</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-color-text)">)</span></span>
<span><span style="color: var(--shiki-color-text)">ret_2 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">java</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">lang</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">StringConcatHelper</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-function)">mix</span><span style="color: var(--shiki-color-text)">(ret_1</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">0</span><span style="color: var(--shiki-color-text)">)</span></span>
<span><span style="color: var(--shiki-color-text)">sp_0x20 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">java</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">io</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">PrintStream</span><span style="color: var(--shiki-color-text)">@</span><span style="color: var(--shiki-token-keyword)">0x554fe8</span></span>
<span><span style="color: var(--shiki-color-text)">sp_0x18 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> Class{[B}</span><span style="color: var(--shiki-token-keyword)">_1</span></span>
<span><span style="color: var(--shiki-color-text)">tlab_0 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> Class{[B}</span><span style="color: var(--shiki-token-keyword)">_1</span></span>
<span><span style="color: var(--shiki-token-constant)">tlab_0</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">length</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> ret_2</span><span style="color: var(--shiki-token-keyword)">&amp;</span><span style="color: var(--shiki-color-text)">lt;</span><span style="color: var(--shiki-token-keyword)">&amp;</span><span style="color: var(--shiki-color-text)">lt;ret_2</span><span style="color: var(--shiki-token-keyword)">&amp;</span><span style="color: var(--shiki-color-text)">gt;</span><span style="color: var(--shiki-token-keyword)">&amp;</span><span style="color: var(--shiki-color-text)">gt;</span><span style="color: var(--shiki-token-constant)">32</span></span>
<span><span style="color: var(--shiki-color-text)">sp_0x10 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> tlab_0</span></span>
<span><span style="color: var(--shiki-color-text)">ret_28 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">?</span><span style="color: var(--shiki-token-constant)">java</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">lang</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">StringConcatHelper</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-function)">prepend</span><span style="color: var(--shiki-color-text)">(tlab_0</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&quot; &quot;</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> ret_2)</span></span>
<span><span style="color: var(--shiki-color-text)">ret_29 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">java</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">lang</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">StringConcatHelper</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-function)">prepend</span><span style="color: var(--shiki-color-text)">(ret_28</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> sp_0x10</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">0</span><span style="color: var(--shiki-color-text)">)</span></span>
<span><span style="color: var(--shiki-color-text)">ret_30 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">?</span><span style="color: var(--shiki-token-constant)">java</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">lang</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">StringConcatHelper</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-function)">newString</span><span style="color: var(--shiki-color-text)">(sp_0x10</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> ret_29)</span></span>
<span><span style="color: var(--shiki-token-constant)">java</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">io</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">PrintStream</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-function)">write</span><span style="color: var(--shiki-color-text)">(sp_0x20</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> ret_30)</span></span>
<span></span></code></pre><button type="button" class="group/button absolute right-4 top-3.5 overflow-hidden rounded-full py-1 pl-2 pr-3 text-2xs font-medium opacity-0 backdrop-blur transition focus:opacity-100 group-hover:opacity-100 bg-white/5 hover:bg-white/7.5 dark:bg-white/2.5 dark:hover:bg-white/5"><span aria-hidden="false" class="pointer-events-none flex items-center gap-0.5 text-zinc-400 transition duration-300"><svg viewBox="0 0 20 20" aria-hidden="true" class="h-5 w-5 fill-zinc-500/20 stroke-zinc-500 transition-colors group-hover/button:stroke-zinc-400"><path stroke-width="0" d="M5.5 13.5v-5a2 2 0 0 1 2-2l.447-.894A2 2 0 0 1 9.737 4.5h.527a2 2 0 0 1 1.789 1.106l.447.894a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2Z"></path><path fill="none" stroke-linejoin="round" d="M12.5 6.5a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2m5 0-.447-.894a2 2 0 0 0-1.79-1.106h-.527a2 2 0 0 0-1.789 1.106L7.5 6.5m5 0-1 1h-3l-1-1"></path></svg>Copy</span><span aria-hidden="true" class="pointer-events-none absolute inset-0 flex items-center justify-center text-primary-400 transition duration-300 translate-y-1.5 opacity-0">Copied!</span></button></div></div></div>
<p>我们在Java代码中非常简单的字符串相加操作，在Java背后实际转为了<code>StringConcatHelper.mix</code>，<code>StringConcatHelper.prepend</code>,<code>StringConcatHelper.newString</code>三个函数的调用，其中<code>StringConcatHelper.mix</code>计算字符串相加后的长度，<code>StringConcatHelper.prepend</code>用来将具体承载字符串内容的byte[]数组组合在一起，<code>StringConcatHelper.newString</code>则通过byte[]数组生成一个新的String对象</p>
<p>我们在上面这段代码看到了两个类型的变量名称，<code>sp_0x18</code>与<code>tlab_0</code>，sp_开头的变量，表示这是一个在栈上分配的变量，<code>tlab_</code>开头的变量表示在Thread Local Allocation Buffers上分配的变量，这里仅是对这两种变量名称的由来做一个说明，在还原代码中这两类变量没有区别，关于Thread Local Allocation Buffers的相关资料，大家可以自行查找。</p>
<p>我们这里给<code>tlab_0</code>赋值为<code>Class{[B}_1</code>, <code>Class{[B}_1</code>的含义是这是byte[]类型的对象实例, [B为byte[]类型的Java描述符，_1表示是这个类型的第一个变量，后续如果再定义了对应类型的变量则序号相应增加，如<code>Class{[B]}_2</code>,<code>Class{[B]}_3</code>等，如果是其他类型也是同样的表示方式如<code>Class{java.lang.String}_1</code>, <code>Class{java.util.HashMap}_2</code>等</p>
<p>上面这段代码的逻辑简单解释了创建一个byte[]数组实例，并赋值给tlab0，数组长度为<code>ret_2 &amp;lt;&amp;lt; ret_2 &amp;gt;&amp;gt;32</code>，数组的长度之所以是<code>ret_2 &amp;lt;&amp;lt; ret_2 &amp;gt;&amp;gt; 32</code>，是因为String计算长度时需要根据编码对数组长度进行一定的换算，大家可以查找java.lang.String.java中的相关代码。接下来即通过prepend函数将0，1还有空格都并入到tlab0，再从tlab_0中生成一个新的String对象ret_30，传递给java.io.PrintStream.write函数打印输出。其实这里还原出来的prepend函数的参数，并不是很正确，参数的位置也不正确，这也是后面需要再完善的一个地方。</p>
<p>两行的Java代码转换成实际的执行逻辑之后，还是比较复杂的，后续可以在目前已还原代码的基础上通过分析整合为简化的模式。</p>
<p>继续往下走</p>
<div class="not-prose my-6 overflow-hidden rounded-2xl bg-zinc-900 shadow-md dark:ring-1 dark:ring-white/10"><div class="group dark:bg-white/2.5"><div class="relative"><pre class="overflow-x-auto p-4 text-xs text-white"><code class="language-java"><span><span style="color: var(--shiki-token-keyword)">for</span><span style="color: var(--shiki-color-text)"> (</span><span style="color: var(--shiki-token-keyword)">int</span><span style="color: var(--shiki-color-text)"> i </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">2</span><span style="color: var(--shiki-color-text)">; i </span><span style="color: var(--shiki-token-keyword)">&amp;</span><span style="color: var(--shiki-color-text)">lt; count; </span><span style="color: var(--shiki-token-keyword)">++</span><span style="color: var(--shiki-color-text)">i){</span></span>
<span><span style="color: var(--shiki-color-text)">  	n3 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> n1 </span><span style="color: var(--shiki-token-keyword)">+</span><span style="color: var(--shiki-color-text)"> n2;</span></span>
<span><span style="color: var(--shiki-color-text)">  	</span><span style="color: var(--shiki-token-constant)">System</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">out</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-function)">print</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">&quot; &quot;</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">+</span><span style="color: var(--shiki-color-text)"> n3);</span></span>
<span><span style="color: var(--shiki-color-text)">  	n1 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> n2;</span></span>
<span><span style="color: var(--shiki-color-text)">  	n2 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> n3;</span></span>
<span><span style="color: var(--shiki-color-text)">}</span></span>
<span><span style="color: var(--shiki-token-constant)">System</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">out</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-function)">println</span><span style="color: var(--shiki-color-text)">();</span></span>
<span></span></code></pre><button type="button" class="group/button absolute right-4 top-3.5 overflow-hidden rounded-full py-1 pl-2 pr-3 text-2xs font-medium opacity-0 backdrop-blur transition focus:opacity-100 group-hover:opacity-100 bg-white/5 hover:bg-white/7.5 dark:bg-white/2.5 dark:hover:bg-white/5"><span aria-hidden="false" class="pointer-events-none flex items-center gap-0.5 text-zinc-400 transition duration-300"><svg viewBox="0 0 20 20" aria-hidden="true" class="h-5 w-5 fill-zinc-500/20 stroke-zinc-500 transition-colors group-hover/button:stroke-zinc-400"><path stroke-width="0" d="M5.5 13.5v-5a2 2 0 0 1 2-2l.447-.894A2 2 0 0 1 9.737 4.5h.527a2 2 0 0 1 1.789 1.106l.447.894a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2Z"></path><path fill="none" stroke-linejoin="round" d="M12.5 6.5a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2m5 0-.447-.894a2 2 0 0 0-1.79-1.106h-.527a2 2 0 0 0-1.789 1.106L7.5 6.5m5 0-1 1h-3l-1-1"></path></svg>Copy</span><span aria-hidden="true" class="pointer-events-none absolute inset-0 flex items-center justify-center text-primary-400 transition duration-300 translate-y-1.5 opacity-0">Copied!</span></button></div></div></div>
<p>对应的是</p>
<div class="not-prose my-6 overflow-hidden rounded-2xl bg-zinc-900 shadow-md dark:ring-1 dark:ring-white/10"><div class="group dark:bg-white/2.5"><div class="relative"><pre class="overflow-x-auto p-4 text-xs text-white"><code class="language-java"><span><span style="color: var(--shiki-token-keyword)">if</span><span style="color: var(--shiki-color-text)">(sp_0x44</span><span style="color: var(--shiki-token-keyword)">&amp;</span><span style="color: var(--shiki-color-text)">gt;</span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-token-constant)">3</span><span style="color: var(--shiki-color-text)">)</span></span>
<span><span style="color: var(--shiki-color-text)">{</span></span>
<span><span style="color: var(--shiki-color-text)">	ret_7 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">java</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">lang</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">StringConcatHelper</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-function)">mix</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-color-text)">)</span></span>
<span><span style="color: var(--shiki-color-text)">	tlab_1 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> sp_0x18</span></span>
<span><span style="color: var(--shiki-color-text)">	</span><span style="color: var(--shiki-token-constant)">tlab_1</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">length</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> ret_7</span><span style="color: var(--shiki-token-keyword)">&amp;</span><span style="color: var(--shiki-color-text)">lt;</span><span style="color: var(--shiki-token-keyword)">&amp;</span><span style="color: var(--shiki-color-text)">lt;ret_7</span><span style="color: var(--shiki-token-keyword)">&amp;</span><span style="color: var(--shiki-color-text)">gt;</span><span style="color: var(--shiki-token-keyword)">&amp;</span><span style="color: var(--shiki-color-text)">gt;</span><span style="color: var(--shiki-token-constant)">32</span></span>
<span><span style="color: var(--shiki-color-text)">	sp_0x10 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&quot; &quot;</span></span>
<span><span style="color: var(--shiki-color-text)">	sp_0x8 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> tlab_1</span></span>
<span><span style="color: var(--shiki-color-text)">	ret_22 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">?</span><span style="color: var(--shiki-token-constant)">java</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">lang</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">StringConcatHelper</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-function)">prepend</span><span style="color: var(--shiki-color-text)">(tlab_1</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&quot; &quot;</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> ret_7)</span></span>
<span><span style="color: var(--shiki-color-text)">	ret_23 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">?</span><span style="color: var(--shiki-token-constant)">java</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">lang</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">StringConcatHelper</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-function)">newString</span><span style="color: var(--shiki-color-text)">(sp_0x8</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> ret_22)</span></span>
<span><span style="color: var(--shiki-color-text)">	rsi </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> ret_23</span></span>
<span><span style="color: var(--shiki-color-text)">	</span><span style="color: var(--shiki-token-constant)">java</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">io</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">PrintStream</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-function)">write</span><span style="color: var(--shiki-color-text)">(sp_0x20</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> ret_23)</span></span>
<span><span style="color: var(--shiki-color-text)">	rdi </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">1</span></span>
<span><span style="color: var(--shiki-color-text)">	rdx </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">1</span></span>
<span><span style="color: var(--shiki-color-text)">	rcx </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">3</span></span>
<span><span style="color: var(--shiki-color-text)">	</span><span style="color: var(--shiki-token-keyword)">while</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">true</span><span style="color: var(--shiki-color-text)">)</span></span>
<span><span style="color: var(--shiki-color-text)">	{</span></span>
<span><span style="color: var(--shiki-color-text)">		</span><span style="color: var(--shiki-token-keyword)">if</span><span style="color: var(--shiki-color-text)">(sp_0x44</span><span style="color: var(--shiki-token-keyword)">&amp;</span><span style="color: var(--shiki-color-text)">lt;</span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)">rcx)</span></span>
<span><span style="color: var(--shiki-color-text)">		{</span></span>
<span><span style="color: var(--shiki-color-text)">			</span><span style="color: var(--shiki-token-keyword)">break</span></span>
<span><span style="color: var(--shiki-color-text)">		}</span></span>
<span><span style="color: var(--shiki-color-text)">		</span><span style="color: var(--shiki-token-keyword)">else</span></span>
<span><span style="color: var(--shiki-color-text)">		{</span></span>
<span><span style="color: var(--shiki-color-text)">			sp_0x34 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> rcx</span></span>
<span><span style="color: var(--shiki-color-text)">			rdi </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> rdi</span><span style="color: var(--shiki-token-keyword)">+</span><span style="color: var(--shiki-color-text)">rdx</span></span>
<span><span style="color: var(--shiki-color-text)">			r9 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> rdi</span></span>
<span><span style="color: var(--shiki-color-text)">			sp_0x30 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> rdx</span></span>
<span><span style="color: var(--shiki-color-text)">			sp_0x2c </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> r9</span></span>
<span><span style="color: var(--shiki-color-text)">			ret_11 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">java</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">lang</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">StringConcatHelper</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-function)">mix</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> r9)</span></span>
<span><span style="color: var(--shiki-color-text)">			tlab_2 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> sp_0x18</span></span>
<span><span style="color: var(--shiki-color-text)">			</span><span style="color: var(--shiki-token-constant)">tlab_2</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">length</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> ret_11</span><span style="color: var(--shiki-token-keyword)">&amp;</span><span style="color: var(--shiki-color-text)">lt;</span><span style="color: var(--shiki-token-keyword)">&amp;</span><span style="color: var(--shiki-color-text)">lt;ret_11</span><span style="color: var(--shiki-token-keyword)">&amp;</span><span style="color: var(--shiki-color-text)">gt;</span><span style="color: var(--shiki-token-keyword)">&amp;</span><span style="color: var(--shiki-color-text)">gt;</span><span style="color: var(--shiki-token-constant)">32</span></span>
<span><span style="color: var(--shiki-color-text)">			sp_0x8 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> tlab_2</span></span>
<span><span style="color: var(--shiki-color-text)">			ret_17 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">?</span><span style="color: var(--shiki-token-constant)">java</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">lang</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">StringConcatHelper</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-function)">prepend</span><span style="color: var(--shiki-color-text)">(tlab_2</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> sp_0x10</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> ret_11)</span></span>
<span><span style="color: var(--shiki-color-text)">			ret_18 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">?</span><span style="color: var(--shiki-token-constant)">java</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">lang</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">StringConcatHelper</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-function)">newString</span><span style="color: var(--shiki-color-text)">(sp_0x8</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> ret_17)</span></span>
<span><span style="color: var(--shiki-color-text)">			rsi </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> ret_18</span></span>
<span><span style="color: var(--shiki-color-text)">			</span><span style="color: var(--shiki-token-constant)">java</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">io</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">PrintStream</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-function)">write</span><span style="color: var(--shiki-color-text)">(sp_0x20</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> ret_18)</span></span>
<span><span style="color: var(--shiki-color-text)">			rcx </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> sp_0x34</span><span style="color: var(--shiki-token-keyword)">+</span><span style="color: var(--shiki-token-constant)">1</span></span>
<span><span style="color: var(--shiki-color-text)">			rdi </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> sp_0x30</span></span>
<span><span style="color: var(--shiki-color-text)">			rdx </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> sp_0x2c</span></span>
<span><span style="color: var(--shiki-color-text)">		}</span></span>
<span><span style="color: var(--shiki-color-text)">	}</span></span>
<span><span style="color: var(--shiki-color-text)">}</span></span>
<span><span style="color: var(--shiki-token-constant)">java</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">io</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-constant)">PrintStream</span><span style="color: var(--shiki-token-punctuation)">.</span><span style="color: var(--shiki-token-function)">newLine</span><span style="color: var(--shiki-color-text)">(sp_0x20</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> rsi)</span></span>
<span><span style="color: var(--shiki-token-keyword)">return</span></span>
<span></span>
<span></span></code></pre><button type="button" class="group/button absolute right-4 top-3.5 overflow-hidden rounded-full py-1 pl-2 pr-3 text-2xs font-medium opacity-0 backdrop-blur transition focus:opacity-100 group-hover:opacity-100 bg-white/5 hover:bg-white/7.5 dark:bg-white/2.5 dark:hover:bg-white/5"><span aria-hidden="false" class="pointer-events-none flex items-center gap-0.5 text-zinc-400 transition duration-300"><svg viewBox="0 0 20 20" aria-hidden="true" class="h-5 w-5 fill-zinc-500/20 stroke-zinc-500 transition-colors group-hover/button:stroke-zinc-400"><path stroke-width="0" d="M5.5 13.5v-5a2 2 0 0 1 2-2l.447-.894A2 2 0 0 1 9.737 4.5h.527a2 2 0 0 1 1.789 1.106l.447.894a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2Z"></path><path fill="none" stroke-linejoin="round" d="M12.5 6.5a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2m5 0-.447-.894a2 2 0 0 0-1.79-1.106h-.527a2 2 0 0 0-1.789 1.106L7.5 6.5m5 0-1 1h-3l-1-1"></path></svg>Copy</span><span aria-hidden="true" class="pointer-events-none absolute inset-0 flex items-center justify-center text-primary-400 transition duration-300 translate-y-1.5 opacity-0">Copied!</span></button></div></div></div>
<p><code>sp_0x44</code>为我们输入给程序的参数，即为count，count只有&gt;=3才会执行Java代码中的for循环，这里将for循环还原为while循环，本质上语义是一质的，在while循环之外，程序代码执行了count=3的逻辑，如果count&lt;=3，程序即执行完成，不会再进入while循环，这可能也是GraalVM在编译时做得一个优化。</p>
<p>我们再看下循环的跳出条件</p>
<div class="not-prose my-6 overflow-hidden rounded-2xl bg-zinc-900 shadow-md dark:ring-1 dark:ring-white/10"><div class="group dark:bg-white/2.5"><div class="relative"><pre class="overflow-x-auto p-4 text-xs text-white"><code>if(sp_0x44&lt;=rcx)
{
		break
}
</code></pre><button type="button" class="group/button absolute right-4 top-3.5 overflow-hidden rounded-full py-1 pl-2 pr-3 text-2xs font-medium opacity-0 backdrop-blur transition focus:opacity-100 group-hover:opacity-100 bg-white/5 hover:bg-white/7.5 dark:bg-white/2.5 dark:hover:bg-white/5"><span aria-hidden="false" class="pointer-events-none flex items-center gap-0.5 text-zinc-400 transition duration-300"><svg viewBox="0 0 20 20" aria-hidden="true" class="h-5 w-5 fill-zinc-500/20 stroke-zinc-500 transition-colors group-hover/button:stroke-zinc-400"><path stroke-width="0" d="M5.5 13.5v-5a2 2 0 0 1 2-2l.447-.894A2 2 0 0 1 9.737 4.5h.527a2 2 0 0 1 1.789 1.106l.447.894a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2Z"></path><path fill="none" stroke-linejoin="round" d="M12.5 6.5a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2m5 0-.447-.894a2 2 0 0 0-1.79-1.106h-.527a2 2 0 0 0-1.789 1.106L7.5 6.5m5 0-1 1h-3l-1-1"></path></svg>Copy</span><span aria-hidden="true" class="pointer-events-none absolute inset-0 flex items-center justify-center text-primary-400 transition duration-300 translate-y-1.5 opacity-0">Copied!</span></button></div></div></div>
<p>此处即对应了</p>
<div class="not-prose my-6 overflow-hidden rounded-2xl bg-zinc-900 shadow-md dark:ring-1 dark:ring-white/10"><div class="group dark:bg-white/2.5"><div class="relative"><pre class="overflow-x-auto p-4 text-xs text-white"><code>i &lt; count
</code></pre><button type="button" class="group/button absolute right-4 top-3.5 overflow-hidden rounded-full py-1 pl-2 pr-3 text-2xs font-medium opacity-0 backdrop-blur transition focus:opacity-100 group-hover:opacity-100 bg-white/5 hover:bg-white/7.5 dark:bg-white/2.5 dark:hover:bg-white/5"><span aria-hidden="false" class="pointer-events-none flex items-center gap-0.5 text-zinc-400 transition duration-300"><svg viewBox="0 0 20 20" aria-hidden="true" class="h-5 w-5 fill-zinc-500/20 stroke-zinc-500 transition-colors group-hover/button:stroke-zinc-400"><path stroke-width="0" d="M5.5 13.5v-5a2 2 0 0 1 2-2l.447-.894A2 2 0 0 1 9.737 4.5h.527a2 2 0 0 1 1.789 1.106l.447.894a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2Z"></path><path fill="none" stroke-linejoin="round" d="M12.5 6.5a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2m5 0-.447-.894a2 2 0 0 0-1.79-1.106h-.527a2 2 0 0 0-1.789 1.106L7.5 6.5m5 0-1 1h-3l-1-1"></path></svg>Copy</span><span aria-hidden="true" class="pointer-events-none absolute inset-0 flex items-center justify-center text-primary-400 transition duration-300 translate-y-1.5 opacity-0">Copied!</span></button></div></div></div>
<p>同时rcx在每次循环过程中也在累加</p>
<div class="not-prose my-6 overflow-hidden rounded-2xl bg-zinc-900 shadow-md dark:ring-1 dark:ring-white/10"><div class="group dark:bg-white/2.5"><div class="relative"><pre class="overflow-x-auto p-4 text-xs text-white"><code>sp_0x34 = rcx
rcx = sp_0x34+1
</code></pre><button type="button" class="group/button absolute right-4 top-3.5 overflow-hidden rounded-full py-1 pl-2 pr-3 text-2xs font-medium opacity-0 backdrop-blur transition focus:opacity-100 group-hover:opacity-100 bg-white/5 hover:bg-white/7.5 dark:bg-white/2.5 dark:hover:bg-white/5"><span aria-hidden="false" class="pointer-events-none flex items-center gap-0.5 text-zinc-400 transition duration-300"><svg viewBox="0 0 20 20" aria-hidden="true" class="h-5 w-5 fill-zinc-500/20 stroke-zinc-500 transition-colors group-hover/button:stroke-zinc-400"><path stroke-width="0" d="M5.5 13.5v-5a2 2 0 0 1 2-2l.447-.894A2 2 0 0 1 9.737 4.5h.527a2 2 0 0 1 1.789 1.106l.447.894a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2Z"></path><path fill="none" stroke-linejoin="round" d="M12.5 6.5a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2m5 0-.447-.894a2 2 0 0 0-1.79-1.106h-.527a2 2 0 0 0-1.789 1.106L7.5 6.5m5 0-1 1h-3l-1-1"></path></svg>Copy</span><span aria-hidden="true" class="pointer-events-none absolute inset-0 flex items-center justify-center text-primary-400 transition duration-300 translate-y-1.5 opacity-0">Copied!</span></button></div></div></div>
<p>即对应了</p>
<div class="not-prose my-6 overflow-hidden rounded-2xl bg-zinc-900 shadow-md dark:ring-1 dark:ring-white/10"><div class="group dark:bg-white/2.5"><div class="relative"><pre class="overflow-x-auto p-4 text-xs text-white"><code>++i
</code></pre><button type="button" class="group/button absolute right-4 top-3.5 overflow-hidden rounded-full py-1 pl-2 pr-3 text-2xs font-medium opacity-0 backdrop-blur transition focus:opacity-100 group-hover:opacity-100 bg-white/5 hover:bg-white/7.5 dark:bg-white/2.5 dark:hover:bg-white/5"><span aria-hidden="false" class="pointer-events-none flex items-center gap-0.5 text-zinc-400 transition duration-300"><svg viewBox="0 0 20 20" aria-hidden="true" class="h-5 w-5 fill-zinc-500/20 stroke-zinc-500 transition-colors group-hover/button:stroke-zinc-400"><path stroke-width="0" d="M5.5 13.5v-5a2 2 0 0 1 2-2l.447-.894A2 2 0 0 1 9.737 4.5h.527a2 2 0 0 1 1.789 1.106l.447.894a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2Z"></path><path fill="none" stroke-linejoin="round" d="M12.5 6.5a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2m5 0-.447-.894a2 2 0 0 0-1.79-1.106h-.527a2 2 0 0 0-1.789 1.106L7.5 6.5m5 0-1 1h-3l-1-1"></path></svg>Copy</span><span aria-hidden="true" class="pointer-events-none absolute inset-0 flex items-center justify-center text-primary-400 transition duration-300 translate-y-1.5 opacity-0">Copied!</span></button></div></div></div>
<p>接下来，我们看看循环体中关于数值相加的逻辑如何在还原后的代码中体现，原始代码为</p>
<div class="not-prose my-6 overflow-hidden rounded-2xl bg-zinc-900 shadow-md dark:ring-1 dark:ring-white/10"><div class="group dark:bg-white/2.5"><div class="relative"><pre class="overflow-x-auto p-4 text-xs text-white"><code class="language-java"><span><span style="color: var(--shiki-token-keyword)">for</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-punctuation)">......</span><span style="color: var(--shiki-color-text)">){</span></span>
<span><span style="color: var(--shiki-color-text)">	</span><span style="color: var(--shiki-token-punctuation)">......</span></span>
<span><span style="color: var(--shiki-color-text)">  n3 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> n1 </span><span style="color: var(--shiki-token-keyword)">+</span><span style="color: var(--shiki-color-text)"> n2;</span></span>
<span><span style="color: var(--shiki-color-text)">	n1 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> n2;</span></span>
<span><span style="color: var(--shiki-color-text)">	n2 </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> n3;</span></span>
<span><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-punctuation)">......</span></span>
<span><span style="color: var(--shiki-color-text)">}</span></span>
<span></span></code></pre><button type="button" class="group/button absolute right-4 top-3.5 overflow-hidden rounded-full py-1 pl-2 pr-3 text-2xs font-medium opacity-0 backdrop-blur transition focus:opacity-100 group-hover:opacity-100 bg-white/5 hover:bg-white/7.5 dark:bg-white/2.5 dark:hover:bg-white/5"><span aria-hidden="false" class="pointer-events-none flex items-center gap-0.5 text-zinc-400 transition duration-300"><svg viewBox="0 0 20 20" aria-hidden="true" class="h-5 w-5 fill-zinc-500/20 stroke-zinc-500 transition-colors group-hover/button:stroke-zinc-400"><path stroke-width="0" d="M5.5 13.5v-5a2 2 0 0 1 2-2l.447-.894A2 2 0 0 1 9.737 4.5h.527a2 2 0 0 1 1.789 1.106l.447.894a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2Z"></path><path fill="none" stroke-linejoin="round" d="M12.5 6.5a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2m5 0-.447-.894a2 2 0 0 0-1.79-1.106h-.527a2 2 0 0 0-1.789 1.106L7.5 6.5m5 0-1 1h-3l-1-1"></path></svg>Copy</span><span aria-hidden="true" class="pointer-events-none absolute inset-0 flex items-center justify-center text-primary-400 transition duration-300 translate-y-1.5 opacity-0">Copied!</span></button></div></div></div>
<p>还原后的代码为</p>
<div class="not-prose my-6 overflow-hidden rounded-2xl bg-zinc-900 shadow-md dark:ring-1 dark:ring-white/10"><div class="group dark:bg-white/2.5"><div class="relative"><pre class="overflow-x-auto p-4 text-xs text-white"><code>while(true){
	......
  rdi = rdi+rdx 	-&gt; n3 = n1 + n2
  r9 = rdi				-&gt; r9 = n3
  sp_0x30 = rdx		-&gt; sp_0x30 = n2
  sp_0x2c = r9		-&gt; sp_0x2c = n3
  rdi = sp_0x30 	-&gt; n1 = sp_0x30 = n2
  rdx = sp_0x2c		-&gt; n2 = sp_0x2c = n3
  ......
}
</code></pre><button type="button" class="group/button absolute right-4 top-3.5 overflow-hidden rounded-full py-1 pl-2 pr-3 text-2xs font-medium opacity-0 backdrop-blur transition focus:opacity-100 group-hover:opacity-100 bg-white/5 hover:bg-white/7.5 dark:bg-white/2.5 dark:hover:bg-white/5"><span aria-hidden="false" class="pointer-events-none flex items-center gap-0.5 text-zinc-400 transition duration-300"><svg viewBox="0 0 20 20" aria-hidden="true" class="h-5 w-5 fill-zinc-500/20 stroke-zinc-500 transition-colors group-hover/button:stroke-zinc-400"><path stroke-width="0" d="M5.5 13.5v-5a2 2 0 0 1 2-2l.447-.894A2 2 0 0 1 9.737 4.5h.527a2 2 0 0 1 1.789 1.106l.447.894a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2Z"></path><path fill="none" stroke-linejoin="round" d="M12.5 6.5a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2m5 0-.447-.894a2 2 0 0 0-1.79-1.106h-.527a2 2 0 0 0-1.789 1.106L7.5 6.5m5 0-1 1h-3l-1-1"></path></svg>Copy</span><span aria-hidden="true" class="pointer-events-none absolute inset-0 flex items-center justify-center text-primary-400 transition duration-300 translate-y-1.5 opacity-0">Copied!</span></button></div></div></div>
<p>循环体中的其他代码即跟前面一样执行字符串相加与输出操作，还原后的代码基本体现了原代码的执行逻辑。</p>
<h2 id="" class="scroll-mt-24"><a class="group text-inherit no-underline hover:text-inherit" href="/articles/graalvm-nativeimage-reverse-engineering/#">还需要进一步完善的地方</a></h2>
<p>目前这个工具已能够基本还原程序控制流，实现一定程度的数据流分析与函数名称还原，要成为一个完善可用的工具，还需要完成下面几点：</p>
<ol>
<li>
<p>较为准确的函数名称、函数参数、函数返回值还原</p>
</li>
<li>
<p>较为准确的对象信息与字段的还原</p>
</li>
<li>
<p>较为准确的表达式与对象类型推断</p>
</li>
<li>
<p>语句整合与简化</p>
</li>
</ol>
<h2 id="" class="scroll-mt-24"><a class="group text-inherit no-underline hover:text-inherit" href="/articles/graalvm-nativeimage-reverse-engineering/#">关于二进制保护的思考</a></h2>
<p>本项目的目的在于探讨NativeImage逆向还原的可行性，从目前的成果来看，NativeImage的逆向还原是可行的，这也给代码保护带来了更高的挑战，许多的开发者认为，将软件编译为二进制即可高枕无忧了，而忽略了对二进制代码的保护。对于C/C++编写的软件，目前许多工具，比如IDA已经有了非常好的还原效果，甚至暴露程度不低于Java程序，笔者甚至看到有些以二进制形式发行的软件，连函数名称的符号信息都不去除，此种情况下无异于裸奔。</p>
<p>任何的代码都是由逻辑组成，只要其包含逻辑，就有可能通过逆向的手段还原其逻辑，只不过在于还原难度的差别而已，而代码保护工作就是尽最大程度是加大这种还原的难度。</p>
<p>最后，在此求个关注，这是本公众号的第一篇文章，大家如果觉得文章内容有价值，欢迎转发关注。后续将努力为大家奉献关于程序开发、逆向保护、网络安全等方面有价值的内容，与大家共同交流学习，谢谢！</p></article></div></main><footer class="z-10"><div class="bg-gray-50 dark:bg-gray-900"><div class="w-full"><div class="mx-auto p-4 py-6 lg:py-8 max-w-screen-xl mx-auto"><div class="md:flex md:justify-between"><div class="mb-6 md:mb-0"><a class="flex items-center" href="/"><img alt="Protector4J Logo" loading="lazy" width="192" height="192" decoding="async" data-nimg="1" class="h-8 w-8 mr-3" style="color:transparent" src="/_next/static/media/p4j.0b69c567.png"/><span class="self-center text-2xl font-semibold whitespace-nowrap dark:text-white">Protector4J</span></a></div><div class="grid grid-cols-2 gap-8 sm:gap-6 sm:grid-cols-2"><div><h2 class="mb-6 text-sm font-semibold text-gray-900 uppercase dark:text-white">Follow us</h2><ul class="text-gray-600 dark:text-gray-400 font-medium"><li class="mb-4"><a class="hover:underline " href="https://github.com/vlinx-io">Github</a></li><li class="mb-4"><a class="hover:underline " href="https://www.youtube.com/playlist?list=PLCatKLfSd7dPSHKB1HbEIHMmGEg8JIL6Q">YouTube</a></li><li class="mb-4"><a class="hover:underline " href="https://twitter.com/vlinx_soft">Twitter</a></li></ul></div><div><h2 class="mb-6 text-sm font-semibold text-gray-900 uppercase dark:text-white">Legal</h2><ul class="text-gray-600 dark:text-gray-400 font-medium"><li class="mb-4"><a class="hover:underline" href="/privacy/">Privacy Policy</a></li><li class="mb-4"><a class="hover:underline" href="/terms/">Terms of Use</a></li><li><a class="hover:underline" href="/eula/">EULA</a></li></ul></div></div></div><hr class="my-6 border-gray-200 sm:mx-auto dark:border-gray-700 lg:my-8"/><div class="sm:flex sm:items-center sm:justify-between"><span class="text-sm text-gray-500 sm:text-center dark:text-gray-400">© 2023 <a class="hover:underline" href="https://vlinx.io/">VLINX Software,Inc.</a> All Rights Reserved.</span><div class="flex mt-4 space-x-6 sm:justify-center sm:mt-0"><a class="text-gray-500 hover:text-gray-900 dark:hover:text-white" href="https://github.com/vlinx-io"><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z" clip-rule="evenodd"></path></svg><span class="sr-only">GitHub account</span></a><a class="text-gray-500 hover:text-gray-900 dark:hover:text-white" href="https://www.youtube.com/playlist?list=PLCatKLfSd7dPSHKB1HbEIHMmGEg8JIL6Q"><svg class="w-5 h-5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 14"><path fill-rule="evenodd" d="M19.7 3.037a4.26 4.26 0 0 0-.789-1.964 2.84 2.84 0 0 0-1.984-.84c-2.767-.2-6.926-.2-6.926-.2s-4.157 0-6.928.2a2.836 2.836 0 0 0-1.983.84A4.225 4.225 0 0 0 .3 3.038a30.148 30.148 0 0 0-.2 3.206v1.5c.01 1.071.076 2.142.2 3.206.094.712.363 1.39.784 1.972.604.536 1.38.837 2.187.848 1.583.15 6.731.2 6.731.2s4.161 0 6.928-.2a2.844 2.844 0 0 0 1.985-.84 4.27 4.27 0 0 0 .787-1.965c.124-1.064.19-2.135.2-3.206V6.243a30.672 30.672 0 0 0-.202-3.206ZM8.008 9.59V3.97l5.4 2.819-5.4 2.8Z" clip-rule="evenodd"></path></svg><span class="sr-only">YouTube</span></a><a class="text-gray-500 hover:text-gray-900 dark:hover:text-white" href="https://twitter.com/vlinx_soft"><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.29 20.251c7.547 0 11.675-6.253 11.675-11.675 0-.178 0-.355-.012-.53A8.348 8.348 0 0022 5.92a8.19 8.19 0 01-2.357.646 4.118 4.118 0 001.804-2.27 8.224 8.224 0 01-2.605.996 4.107 4.107 0 00-6.993 3.743 11.65 11.65 0 01-8.457-4.287 4.106 4.106 0 001.27 5.477A4.072 4.072 0 012.8 9.713v.052a4.105 4.105 0 003.292 4.022 4.095 4.095 0 01-1.853.07 4.108 4.108 0 003.834 2.85A8.233 8.233 0 012 18.407a11.616 11.616 0 006.29 1.84"></path></svg><span class="sr-only">Twitter</span></a></div></div></div></div></div></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"sections":[{"title":"项目地址","id":""},{"title":"生成NativeImage","id":"native-image"},{"title":"分析NativeImage","id":"native-image-2"},{"title":"一个复杂点的程序","id":""},{"title":"还需要进一步完善的地方","id":""},{"title":"关于二进制保护的思考","id":""}],"title":"GraalVM NativeImage 逆向还原"},"__N_SSG":true},"page":"/articles/graalvm-nativeimage-reverse-engineering","query":{},"buildId":"Fa23PQWnAWdb7ainqjCCc","isFallback":false,"gsp":true,"scriptLoader":[]}</script><script src="https://cdnjs.cloudflare.com/ajax/libs/flowbite/1.6.6/flowbite.min.js"></script></body></html>