(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[362],{5237:function(e,s,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/articles/cracking-encrypted-java-applications-jhsdb",function(){return n(475)}])},475:function(e,s,n){"use strict";n.r(s),n.d(s,{__N_SSG:function(){return a}});var t=n(5893),i=n(1151);function r(e){let s=Object.assign({h1:"h1",p:"p",h2:"h2",a:"a",img:"img"},(0,i.ah)(),e.components);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.h1,{children:"Cracking encrypted Java applications using jhsdb (hotspot debugger)"}),"\n",(0,t.jsx)(s.p,{children:"One solution for Java code protection is class file encryption. This type of solution loads the encrypted class file or jar file through a self-defined loader, which is useless due to the existence of the JVM’s Attach mechanism and can be easily cracked with the tools that come with the JDK."}),"\n",(0,t.jsx)(s.h2,{id:"sample-application",children:"Sample Application"}),"\n",(0,t.jsx)(s.p,{children:"Below is a sample application with a simple swing window and a button."}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.a,{href:"https://github.com/3-keys/test-swing-app",children:"https://github.com/3-keys/test-swing-app"})}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{src:"https://vlinx.io/resources/images/1*X7gk1cFs2q_rbFUL1AWGAg.png",alt:"img"})}),"\n",(0,t.jsx)(s.h2,{id:"encrypt-application",children:"Encrypt Application"}),"\n",(0,t.jsx)(s.p,{children:"Export a runnable jar file with Eclipse and use an encryption tool to encrypt the jar file. After encryption, the structure of the jar file is as follows:"}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{src:"https://vlinx.io/resources/images/1*g3newuhVki74x-88x5eCMA.png",alt:"img"})}),"\n",(0,t.jsx)(s.p,{children:"test-swing-app.jar is the encrypted jar file data, the Launcher classes are the custom loading classes of this tool, and the encrypted jar package is still run through the standard java -jar command"}),"\n",(0,t.jsx)(s.h2,{id:"crack-the-encrypted-application",children:"Crack the encrypted application"}),"\n",(0,t.jsx)(s.p,{children:"First, run the encrypted jar file, then find the bin directory of JDK and you should be able to find a jshdb file."}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{src:"https://vlinx.io/resources/images/1_nsxbwNJrGJB4mpzsQv55VA.png",alt:"1_nsxbwNJrGJB4mpzsQv55VA"})}),"\n",(0,t.jsx)(s.p,{children:"Execute jhsdb hsdb, open HotSpot Debugger, if it is under Windows, you may need to run as administrator, click File to select Attach to HotSpot process…,"}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{src:"https://vlinx.io/resources/images/1*hsrnzmr8hzV47HTnARd3Dw.png",alt:"img"})}),"\n",(0,t.jsx)(s.p,{children:"Linux system through ps aux | grep java command, Windows system through the task manager to find the pid of the process, in the following dialog box, enter the process pid"}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{src:"https://vlinx.io/resources/images/1*FNgXH0LmGN0eZ7TqxLHNsg.png",alt:"img"})}),"\n",(0,t.jsx)(s.p,{children:"After successfully attaching it, click Tools->Class Browser"}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{src:"https://vlinx.io/resources/images/1*Tc6T4OeO0QjfrVDCAYZ7sQ.png",alt:"img"})}),"\n",(0,t.jsx)(s.p,{children:"The class Browser contains information about all loaded classes, search for com.example and you may see all the classes under com.example"}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{src:"https://vlinx.io/resources/images/1*jRo1F__YxVTXXuyPizrTLw.png",alt:"img"})}),"\n",(0,t.jsxs)(s.p,{children:["Click on com.example.TestWindow ",(0,t.jsx)(s.a,{href:"http://twitter.com/0x0000",children:"@0x0000"}),"…. and then click “Create .class File”"]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{src:"https://vlinx.io/resources/images/1*rnRW_jIKIeCqNcS5t_DwWA.png",alt:"img"})}),"\n",(0,t.jsx)(s.p,{children:"cd to the directory where the jhsdb command was executed before, you can see the generated class file"}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{src:"https://miro.medium.com/v2/resize:fit:1400/1*YqNI-YMoO34fo0aBnzgYoQ.png",alt:"img"})}),"\n",(0,t.jsxs)(s.p,{children:["Use ",(0,t.jsx)(s.a,{href:"https://github.com/deathmarine/Luyten",children:"Luyten"})," or ",(0,t.jsx)(s.a,{href:"https://github.com/skylot/jadx",children:"jadx"})," to open the class file and you can see the decompiled code"]}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{src:"https://vlinx.io/resources/images/1*zQadcuf88E2Jw_5PkqvlqQ.png",alt:"img"})})]})}var a=!0;s.default=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:s}=Object.assign({},(0,i.ah)(),e.components);return s?(0,t.jsx)(s,Object.assign({},e,{children:(0,t.jsx)(r,e)})):r(e)}}},function(e){e.O(0,[774,888,179],function(){return e(e.s=5237)}),_N_E=e.O()}]);